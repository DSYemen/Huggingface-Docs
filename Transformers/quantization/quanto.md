# Quanto

ููุชุจุฉ ๐คQuanto ูู ูุฌููุนุฉ ุฃุฏูุงุช ูููุฉ ูุชููุนุฉ ุชุนุชูุฏ ุนูู PyTorch. ุทุฑููุฉ ุงูููููููุฉ ุงููุณุชุฎุฏูุฉ ูู ุงูููููููุฉ ุงูุฎุทูุฉ. ูููุฑ Quanto ุงูุนุฏูุฏ ูู ุงูููุฒุงุช ุงููุฑูุฏุฉ ูุซู:

- ููููููุฉ ุงูุฃูุฒุงู (`float8`ุ `int8`ุ `int4`ุ `int2`)
- ููููููุฉ ุงูุชูุดูุท (`float8`ุ `int8`)
- ุนุฏู ุงูุชุฎุตุต ูู ุทุฑููุฉ ูุนููุฉ (ูุซู ุงูุฑุคูุฉ ุงูุญุงุณูุจูุฉุ ูููุงุฐุฌ ุงููุบุฉ ุงููุจูุฑุฉ)
- ุนุฏู ุงูุชุฎุตุต ูู ุฌูุงุฒ ูุนูู (ูุซู CUDA ู MPS ู CPU)
- ุงูุชูุงูู ูุน `torch.compile`
- ุณูููุฉ ุฅุถุงูุฉ ููุงุฉ ูุฎุตุตุฉ ูุฌูุงุฒ ูุญุฏุฏ
- ุฏุนู ุงูุชุฏุฑูุจ ุงููุงุนู ุจุงููููุฉ

ูุจู ุงูุจุฏุกุ ุชุฃูุฏ ูู ุชุซุจูุช ุงูููุชุจุงุช ุงูุชุงููุฉ:

```bash
pip install quanto accelerate transformers
```

ุงูุขู ููููู ููููููุฉ ูููุฐุฌ ุนู ุทุฑูู ุชูุฑูุฑ ูุงุฆู [`QuantoConfig`] ูู ุทุฑููุฉ [`~PreTrainedModel.from_pretrained`]. ูุนูู ูุฐุง ูุน ุฃู ูููุฐุฌ ูู ุฃู ุทุฑููุฉุ ุทุงููุง ุฃูู ูุญุชูู ุนูู ุทุจูุงุช `torch.nn.Linear`.

ูุฏุนู ุงูุชูุงูู ูุน ููุชุจุฉ Transformers ููููููุฉ ุงูุฃูุฒุงู ููุท. ุจุงููุณุจุฉ ูุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุฃูุซุฑ ุชุนููุฏูุง ูุซู ููููููุฉ ุงูุชูุดูุทุ ูุงููุนุงูุฑุฉุ ูุงูุชุฏุฑูุจ ุงููุงุนู ุจุงููููุฉุ ูุฌุจ ุงุณุชุฎุฏุงู ููุชุจุฉ [quanto](https://github.com/huggingface/quanto) ุจุฏูุงู ูู ุฐูู.

```py
from transformers import AutoModelForCausalLM, AutoTokenizer, QuantoConfig

model_id = "facebook/opt-125m"
tokenizer = AutoTokenizer.from_pretrained(model_id)
quantization_config = QuantoConfig(weights="int8")
quantized_model = AutoModelForCausalLM.from_pretrained(model_id, device_map="cuda:0", quantization_config=quantization_config)
```

ูุงุญุธ ุฃู ุงูุชุณูุณู ุงููุฑูู ุบูุฑ ูุฏุนูู ุญุชู ุงูุขู ูุน Transformers ููููู ูุงุฏู ูุฑูุจูุง! ุฅุฐุง ููุช ุชุฑูุฏ ุญูุธ ุงููููุฐุฌุ ูููููู ุงุณุชุฎุฏุงู ููุชุจุฉ quanto ุจุฏูุงู ูู ุฐูู.

ุชุณุชุฎุฏู ููุชุจุฉ quanto ุฎูุงุฑุฒููุฉ ุงูููููููุฉ ุงูุฎุทูุฉ ููููููููุฉ. ุนูู ุงูุฑุบู ูู ุฃู ูุฐู ุชูููุฉ ููููููุฉ ุฃุณุงุณูุฉุ ุฅูุง ุฃููุง ูุญุตู ุนูู ูุชุงุฆุฌ ุฌูุฏุฉ ุฌุฏูุง! ุงูู ูุธุฑุฉ ุนูู ุงููุนูุงุฑ ุงููุฑุฌุนู ุงูุชุงูู (llama-2-7b ุนูู ูููุงุณ ุงูุญูุฑุฉ). ููููู ุงูุนุซูุฑ ุนูู ุงููุฒูุฏ ูู ุงููุนุงููุฑ ุงููุฑุฌุนูุฉ [ููุง](https://github.com/huggingface/quanto/tree/main/bench/generation)

ุชุชูุชุน ุงูููุชุจุฉ ุจุงููุฑููุฉ ุงููุงููุฉ ูุชููู ูุชูุงููุฉ ูุน ูุนุธู ุฎูุงุฑุฒููุงุช ุชุญุณูู PTQ. ูุชุชูุซู ุงูุฎุทุฉ ุงููุณุชูุจููุฉ ูู ุฏูุฌ ุงูุฎูุงุฑุฒููุงุช ุงูุฃูุซุฑ ุดุนุจูุฉ ุจุฃูุซุฑ ุงูุทุฑู ุณูุงุณุฉ (AWQุ Smoothquant).