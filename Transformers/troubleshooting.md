## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง

ูู ุจุนุถ ุงูุฃุญูุงู ุชุญุฏุซ ุงูุฃุฎุทุงุกุ ููููุง ููุง ูููุณุงุนุฏุฉ! ูุบุทู ูุฐุง ุงูุฏููู ุจุนุถูุง ูู ุฃูุซุฑ ุงููุดููุงุช ุดููุนูุง ุงูุชู ุฑุฃููุงูุง ูููู ููููู ุญููุง. ููุน ุฐููุ ูุฅู ูุฐุง ุงูุฏููู ููุณ ุงูููุตูุฏ ููู ุฃู ูููู ูุฌููุนุฉ ุดุงููุฉ ูู ูู ูุดููุฉ ูู Transformers. ููุญุตูู ุนูู ูุฒูุฏ ูู ุงููุณุงุนุฏุฉ ูู ุงุณุชูุดุงู ุฃุฎุทุงุฆู ูุฅุตูุงุญูุงุ ุฌุฑูุจ ูุง ููู:

1. ุงุทูุจ ุงููุณุงุนุฏุฉ ุนูู [ุงูููุชุฏูุงุช](https://discuss.huggingface.co/). ููุงู ูุฆุงุช ูุญุฏุฏุฉ ููููู ูุดุฑ ุณุคุงูู ูููุงุ ูุซู [ุงููุจุชุฏุฆูู](https://discuss.huggingface.co/c/beginners/5) ุฃู [๐ค ุงููุญููุงุช](https://discuss.huggingface.co/c/transformers/9). ุชุฃูุฏ ูู ูุชุงุจุฉ ููุดูุฑ ุฌูุฏ ูุตูู ุนูู ุงูููุชุฏู ูุน ุจุนุถ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุงุจูุฉ ููุชูุฑุงุฑ ูุฒูุงุฏุฉ ุงุญุชูุงู ุญู ูุดููุชู!

2. ูู ุจุฅูุดุงุก [ูุถูุฉ](https://github.com/huggingface/transformers/issues/new/choose) ูู ูุณุชูุฏุน ๐ค ุงููุญููุงุช ุฅุฐุง ูุงู ุงูุฃูุฑ ูุชุนูู ุจุฎุทุฃ ูู ุงูููุชุจุฉ. ุญุงูู ุชุถููู ุฃูุจุฑ ูุฏุฑ ูููู ูู ุงููุนูููุงุช ุงูุชู ุชุตู ุงูุฎุทุฃ ููุณุงุนุฏุชูุง ุจุดูู ุฃูุถู ูู ูุนุฑูุฉ ุงูุฎุทุฃ ูููููุฉ ุฅุตูุงุญู.

3. ุฑุงุฌุน ุฏููู [ุงููุฌุฑุฉ](migration) ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฅุตุฏุงุฑูุง ุฃูุฏู ูู ๐ค ุงููุญููุงุช ุญูุซ ุชู ุชูุฏูู ุจุนุถ ุงูุชุบููุฑุงุช ุงููููุฉ ุจูู ุงูุฅุตุฏุงุฑุงุช.

ููุญุตูู ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง ูุงูุญุตูู ุนูู ุงููุณุงุนุฏุฉุ ุฑุงุฌุน [ุงููุตู 8](https://huggingface.co/course/chapter8/1ุfw=pt) ูู ุฏูุฑุฉ Hugging Face.

## ุจูุฆุงุช ุฌุฏุงุฑ ุงูุญูุงูุฉ

ุชููู ุจุนุถ ูุซููุงุช GPU ูู ุงูุณุญุงุจุฉ ูุฅุนุฏุงุฏุงุช ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุญููุฉ ุจุฌุฏุงุฑ ุญูุงูุฉ ูู ุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉุ ููุง ูุคุฏู ุฅูู ุฎุทุฃ ูู ุงูุงุชุตุงู. ุนูุฏูุง ุชุญุงูู ุชุนูููุงุช ุงูุจุฑูุงูุฌ ุงููุตู ุชูุฒูู ุฃูุฒุงู ุงููููุฐุฌ ุฃู ูุฌููุนุงุช ุงูุจูุงูุงุชุ ุณูุชููู ุงูุชูุฒูู ุซู ููุชูู ุจุฎุทุฃ ุจุงูุฑุณุงูุฉ ุงูุชุงููุฉ:

```
ValueError: ุฎุทุฃ ูู ุงูุงุชุตุงูุ ููุง ูููููุง ุงูุนุซูุฑ ุนูู ุงููููุงุช ุงููุทููุจุฉ ูู ุงููุณุงุฑ ุงููุคูุช.
ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชุฃูุฏ ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช.
```

ูู ูุฐู ุงูุญุงูุฉุ ูุฌุจ ุนููู ูุญุงููุฉ ุชุดุบูู ๐ค ุงููุญููุงุช ูู [ูุถุน ุนุฏู ุงูุงุชุตุงู](installation#offline-mode) ูุชุฌูุจ ุฎุทุฃ ุงูุงุชุตุงู.

## CUDA ููุฏ ุงูุฐุงูุฑุฉ

ูููู ุฃู ูููู ุชุฏุฑูุจ ุงูููุงุฐุฌ ุงููุจูุฑุฉ ุงูุชู ุชุญุชูู ุนูู ููุงููู ุงููุนููุงุช ุฃูุฑูุง ุตุนุจูุง ุจุฏูู ุงูุฃุฌูุฒุฉ ุงูููุงุณุจุฉ. ุฃุญุฏ ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ุงูุชู ูุฏ ุชูุงุฌููุง ุนูุฏูุง ุชููุฏ ุฐุงูุฑุฉ GPU ูู:

```
CUDA out of memory. ุญุงูู ุชุฎุตูุต 256.00 ููุบุง ุจุงูุช (GPU 0ุ ุณุนุฉ ุฅุฌูุงููุฉ ุชุจูุบ 11.17 ุฌูุบุง ุจุงูุชุ 9.70 ุฌูุบุง ุจุงูุช ูุฎุตุตุฉ ุจุงููุนูุ 179.81 ููุบุง ุจุงูุช ูุฌุงููุฉุ 9.85 ุฌูุบุง ุจุงูุช ูุญุฌูุฒุฉ ูู ุงูุฅุฌูุงูู ุจูุงุณุทุฉ PyTorch)
```

ูููุง ููู ุจุนุถ ุงูุญููู ุงููุญุชููุฉ ุงูุชู ููููู ุชุฌุฑุจุชูุง ูุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ:

- ููู ูู ูููุฉ [`per_device_train_batch_size`](main_classes/trainer#transformers.TrainingArguments.per_device_train_batch_size) ูู [`TrainingArguments`].

- ุญุงูู ุงุณุชุฎุฏุงู [`gradient_accumulation_steps`](main_classes/trainer#transformers.TrainingArguments.gradient_accumulation_steps) ูู [`TrainingArguments`] ูุฒูุงุฏุฉ ุญุฌู ุงูุฏููุนุฉ ุจุดูู ูุนุงู.

ุฑุงุฌุน ุฏููู [ุงูุฃุฏุงุก](performance) ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุชูููุงุช ุชูููุฑ ุงูุฐุงูุฑุฉ.

## ูุง ูููู ุชุญููู ูููุฐุฌ TensorFlow ุงููุญููุธ

ุชุณูุญ ุทุฑููุฉ [model.save](https://www.tensorflow.org/tutorials/keras/save_and_load#save_the_entire_model) ูู TensorFlow ุจุญูุธ ุงููููุฐุฌ ุจุงููุงูู - ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉุ ูุงูุฃูุฒุงูุ ูุชูููู ุงูุชุฏุฑูุจ - ูู ููู ูุงุญุฏ. ููุน ุฐููุ ุนูุฏูุง ุชููู ุจุชุญููู ููู ุงููููุฐุฌ ูุฑุฉ ุฃุฎุฑูุ ููุฏ ุชูุงุฌู ุฎุทุฃ ูุฃู ๐ค ุงููุญููุงุช ูุฏ ูุง ุชููู ุจุชุญููู ุฌููุน ุงููุงุฆูุงุช ุงููุชุนููุฉ ุจู TensorFlow ูู ููู ุงููููุฐุฌ. ูุชุฌูุจ ุงููุดููุงุช ุนูุฏ ุญูุธ ููุงุฐุฌ TensorFlow ูุชุญููููุงุ ููุตู ุจูุง ููู:

- ุงุญูุธ ุฃูุฒุงู ุงููููุฐุฌ ูููุญู ููู `h5` ุจุงุณุชุฎุฏุงู [`model.save_weights`](https://www.tensorflow.org/tutorials/keras/save_and_load#save_the_entire_model) ุซู ุฃุนุฏ ุชุญููู ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู [`~TFPreTrainedModel.from_pretrained`]:

```ุจุงูุซูู
ูู ุงููุญููุงุช ุงุณุชูุฑุงุฏ TFPreTrainedModel
ูู ุชูุณูุฑููู ุงุณุชูุฑุงุฏ ููุฑุงุณ

ุงููููุฐุฌ. ุญูุธ ุงูุฃูุฒุงู ("some_folder / tf_model.h5")
ุงููููุฐุฌ = TFPreTrainedModel.from_pretrained ("some_folder")
```

- ุงุญูุธ ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู [`~TFPretrainedModel.save_pretrained`] ููู ุจุชุญูููู ูุฑุฉ ุฃุฎุฑู ุจุงุณุชุฎุฏุงู [`~TFPreTrainedModel.from_pretrained`]:

```ุจุงูุซูู
ูู ุงููุญููุงุช ุงุณุชูุฑุงุฏ TFPreTrainedModel

ุงููููุฐุฌ. ุญูุธ pretrained ("path_to / model")
ุงููููุฐุฌ = TFPreTrainedModel.from_pretrained ("path_to / model")
```

## ImportError

ุฎุทุฃ ุดุงุฆุน ุขุฎุฑ ูุฏ ุชูุงุฌููุ ุฎุงุตุฉ ุฅุฐุง ูุงู ูููุฐุฌูุง ุชู ุฅุตุฏุงุฑู ุญุฏูุซูุงุ ูู `ImportError`:

```
ImportError: ูุง ูููู ุงุณุชูุฑุงุฏ ุงุณู 'ImageGPTImageProcessor' ูู 'ุงููุญููุงุช' (ูููุน ุบูุฑ ูุนุฑูู)
```

ุจุงููุณุจุฉ ูุฃููุงุน ุงูุฃุฎุทุงุก ูุฐูุ ุชุญูู ูู ุชุซุจูุช ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู ๐ค ุงููุญููุงุช ูููุตูู ุฅูู ุฃุญุฏุซ ุงูููุงุฐุฌ:

```bash
pip install transformers --upgrade
```

## ุฎุทุฃ CUDA: ุชู ุชุดุบูู ุงูุชุฃููุฏ ุนูู ุฌุงูุจ ุงูุฌูุงุฒ

ูู ุจุนุถ ุงูุฃุญูุงูุ ูุฏ ุชูุงุฌู ุฎุทุฃ CUDA ุนุงููุง ุญูู ุฎุทุฃ ูู ุฑูุฒ ุงูุฌูุงุฒ.

```
RuntimeError: ุฎุทุฃ CUDA: ุชู ุชุดุบูู ุงูุชุฃููุฏ ุนูู ุฌุงูุจ ุงูุฌูุงุฒ
```

ูุฌุจ ุนููู ูุญุงููุฉ ุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุฃููุงู ููุญุตูู ุนูู ุฑุณุงูุฉ ุฎุทุฃ ุฃูุซุฑ ูุตููุง. ุฃุถู ูุชุบูุฑ ุงูุจูุฆุฉ ุงูุชุงูู ูู ุจุฏุงูุฉ ุฑูุฒู ููุชุจุฏูู ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ:

```ุจุงูุซูู
ุงุณุชูุฑุงุฏ ุฃูุณ

ุฃูุณ. environ ["CUDA_VISIBLE_DEVICES"] = ""
```

ุฎูุงุฑ ุขุฎุฑ ูู ุงูุญุตูู ุนูู ุชุชุจุน ููุฏุณ ุฃูุถู ูู GPU. ุฃุถู ูุชุบูุฑ ุงูุจูุฆุฉ ุงูุชุงูู ูู ุจุฏุงูุฉ ุฑูุฒู ููุญุตูู ุนูู ุชุชุจุน ุงูููุฏุณ ููุฅุดุงุฑุฉ ุฅูู ูุตุฏุฑ ุงูุฎุทุฃ:

```ุจุงูุซูู
ุงุณุชูุฑุงุฏ ุฃูุณ

ุฃูุณ. environ ["CUDA_LAUNCH_BLOCKING"] = "1"
```

## ุฅุฎุฑุงุฌ ุบูุฑ ุตุญูุญ ุนูุฏ ุนุฏู ููุงุน ุฑููุฒ ุงูุญุดู

ูู ุจุนุถ ุงูุญุงูุงุชุ ูุฏ ูููู ุฅุฎุฑุงุฌ `hidden_state` ุบูุฑ ุตุญูุญ ุฅุฐุง ุชุถููุช `input_ids` ุฑููุฒ ุญุดู. ูุฅุซุจุงุช ุฐููุ ูู ุจุชุญููู ูููุฐุฌ ููุตูู ุงูุฑููุฒ. ููููู ุงููุตูู ุฅูู `pad_token_id` ูููููุฐุฌ ููุนุฑูุฉ ูููุชู. ูุฏ ูููู `pad_token_id` `None` ูุจุนุถ ุงูููุงุฐุฌุ ูููู ููููู ุฏุงุฆููุง ุชุนูููู ูุฏูููุง.

```ุจุงูุซูู
ูู ุงููุญููุงุช ุงุณุชูุฑุงุฏ AutoModelForSequenceClassification
ุงุณุชูุฑุงุฏ ุงูุดุนูุฉ

ุงููููุฐุฌ = AutoModelForSequenceClassification.from_pretrained ("google-bert / bert-base-uncased")
ุชูููู ุงููููุฐุฌ. pad_token_id
```

ููุถุญ ุงููุซุงู ุงูุชุงูู ุงูุฅุฎุฑุงุฌ ุจุฏูู ููุงุน ุฑููุฒ ุงูุญุดู:

```ุจุงูุซูู
input_ids = torch.tensor ([[7592ุ 2057ุ 2097ุ 2393ุ 9611ุ 2115]ุ [7592ุ 0ุ 0ุ 0ุ 0ุ 0]])
ุงูุฅุฎุฑุงุฌ = ุงููููุฐุฌ (input_ids)
ุทุจุงุนุฉ (ุงูุฅุฎุฑุงุฌ. logits)
ูุตูููุฉ ุดุนูุฉ
[[0.0082ุ -0.2307]
[0.1317ุ -0.1683]]ุ grad_fn = <AddmmBackward0>
```

ูุฐุง ูู ุงูุฅุฎุฑุงุฌ ุงููุนูู ููุชุณูุณู ุงูุซุงูู:

```ุจุงูุซูู
input_ids = torch.tensor ([[7592]])
ุงูุฅุฎุฑุงุฌ = ุงููููุฐุฌ (input_ids)
ุทุจุงุนุฉ (ุงูุฅุฎุฑุงุฌ. logits)
ูุตูููุฉ ุดุนูุฉ
[[-0.1008ุ -0.4061]]ุ grad_fn = <AddmmBackward0>
```

ูู ูุนุธู ุงูููุชุ ูุฌุจ ุนููู ุชูููุฑ `attention_mask` ูููููุฐุฌ ูุชุฌุงูู ุฑููุฒ ุงูุญุดู ูุชุฌูุจ ูุฐุง ุงูุฎุทุฃ ุงูุตุงูุช. ุงูุขู ูุชุทุงุจู ุฅุฎุฑุงุฌ ุงูุชุณูุณู ุงูุซุงูู ูุน ุงูุฅุฎุฑุงุฌ ุงููุนูู:

ูููู ุงููุตูู ุงูุฑูุฒู ุจุดูู ุงูุชุฑุงุถู ุจุฅูุดุงุก `attention_mask` ูู ุจูุงุกู ุนูู ุงูุชุฑุงุถุงุช ุงููุตูู ุงูุฑูุฒู ุงููุญุฏุฏ.

```ุจุงูุซูู
attention_mask = torch.tensor ([[1ุ 1ุ 1ุ 1ุ 1ุ 1]ุ [1ุ 0ุ 0ุ 0ุ 0ุ 0]])
ุงูุฅุฎุฑุงุฌ = ุงููููุฐุฌ (input_idsุ attention_mask = attention_mask)
ุทุจุงุนุฉ (ุงูุฅุฎุฑุงุฌ. logits)
ูุตูููุฉ ุดุนูุฉ
[[0.0082ุ -0.2307]
[-0.1008ุ -0.4061]]ุ grad_fn = <AddmmBackward0>
```

๐ค ุงููุญููุงุช ูุง ุชููู ุชููุงุฆููุง ุจุฅูุดุงุก `attention_mask` ูููุงุน ุฑูุฒ ุงูุญุดู ุฅุฐุง ุชู ุชูููุฑู ูุฃูู:

- ูุง ุชุญุชูู ุจุนุถ ุงูููุงุฐุฌ ุนูู ุฑูุฒ ุญุดู.

- ุจุงููุณุจุฉ ูุจุนุถ ุญุงูุงุช ุงูุงุณุชุฎุฏุงูุ ูุฑูุฏ ุงููุณุชุฎุฏููู ุฃู ููุชุจู ุงููููุฐุฌ ุฅูู ุฑูุฒ ุงูุญุดู.

## ValueError: ูุฆุฉ ุชูููู ุบูุฑ ูุนุชุฑู ุจูุง XYZ ููุฐุง ุงูููุน ูู AutoModel

ุจุดูู ุนุงูุ ููุตู ุจุงุณุชุฎุฏุงู ูุฆุฉ [`AutoModel`] ูุชุญููู ูุซููุงุช ูุฏุฑุจุฉ ูุณุจููุง ูู ุงูููุงุฐุฌ. ูููู ููุฐู ุงููุฆุฉ ุฃู ุชุณุชูุชุฌ ุชููุงุฆููุง ูุชุญููู ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ ุงูุตุญูุญุฉ ูู ููุทุฉ ุชูุชูุด ูุนููุฉ ุจูุงุกู ุนูู ุงูุชูููู. ุฅุฐุง ุฑุฃูุช

ูุฐุง `ValueError` ุนูุฏ ุชุญููู ูููุฐุฌ ูู ููุทุฉ ุชูุชูุดุ ููุฐุง ูุนูู ุฃู ุงููุฆุฉ ุงูุชููุงุฆูุฉ ูู ุชุชููู ูู ุงูุนุซูุฑ ุนูู ุฎุฑูุทุฉ ูู

ุงูุชูููู ูู ููุทุฉ ุงูุชูุชูุด ุงููุนุทุงุฉ ุฅูู ููุน ุงููููุฐุฌ ุงูุฐู ุชุญุงูู ุชุญูููู. ูุญุฏุซ ูุฐุง ูู ูุนุธู ุงูุฃุญูุงู ุนูุฏูุง ูุง ุชุฏุนู ููุทุฉ ุงูุชูุชูุด ูููุฉ ูุนููุฉ.

ุนูู ุณุจูู ุงููุซุงูุ ุณุชุฑู ุฎุทุฃ ูู ุงููุซุงู ุงูุชุงูู ูุฃูู ูุง ููุฌุฏ GPT2 ููุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ:

```ุจุงูุซูู
ูู ุงููุญููุงุช ุงุณุชูุฑุงุฏ AutoProcessorุ AutoModelForQuestionAnswering

ุงููุนุงูุฌ = AutoProcessor.from_pretrained ("openai-community / gpt2-medium")
ุงููููุฐุฌ = AutoModelForQuestionAnswering.from_pretrained ("openai-community / gpt2-medium")
ValueError: ูุฆุฉ ุงูุชูููู ุบูุฑ ุงููุนุชุฑู ุจูุง <class 'transformers.models.gpt2.configuration_gpt2.GPT2Config'> ููุฐุง ุงูููุน ูู ุงูููุงุฐุฌ ุงูุชููุงุฆูุฉ: AutoModelForQuestionAnswering.
ูุฌุจ ุฃู ูููู ููุน ุงููููุฐุฌ ุฃุญุฏ AlbertConfigุ BartConfigุ BertConfigุ BigBirdConfigุ BigBirdPegasusConfigุ BloomConfigุ ...
```