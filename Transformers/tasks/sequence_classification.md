# ุชุตููู ุงููุต

ูุนุฏ ุชุตููู ุงููุต ูููุฉ ุดุงุฆุนุฉ ูู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉ (NLP) ูุงูุชู ุชููู ุจุชุนููู ุชุณููุฉ ุฃู ูุฆุฉ ูููุต. ูุชุณุชุฎุฏู ุจุนุถ ุฃูุจุฑ ุงูุดุฑูุงุช ุชุตููู ุงููุต ูู ุงูุฅูุชุงุฌ ููุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุชุทุจููุงุช ุงูุนูููุฉ. ุฃุญุฏ ุฃูุซุฑ ุฃุดูุงู ุชุตููู ุงููุต ุดููุนูุง ูู ุชุญููู ุงููุดุงุนุฑุ ูุงูุฐู ูููู ุจุชุนููู ุชุณููุฉ ูุซู ๐ ุฅูุฌุงุจูุฉุ ๐ ุณูุจูุฉุ ุฃู ๐ ูุญุงูุฏุฉ ูุชุณูุณู ูุตู.

ุณููุถุญ ูุฐุง ุงูุฏููู ููููุฉ:

1. ุถุจุท ูููุฐุฌ [DistilBERT](https://huggingface.co/distilbert/distilbert-base-uncased) ุงูุฏููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช [IMDb](https://huggingface.co/datasets/imdb) ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุชูููู ุงููููู ุฅูุฌุงุจููุง ุฃู ุณูุจููุง.
2. ุงุณุชุฎุฏุงู ูููุฐุฌู ุงูุฏููู ููุงุณุชูุชุงุฌ.

ูุจู ุฃู ุชุจุฏุฃุ ุชุฃูุฏ ูู ุชุซุจูุช ุฌููุน ุงูููุชุจุงุช ุงูุถุฑูุฑูุฉ:

```bash
pip install transformers datasets evaluate accelerate
```

ูุญู ูุดุฌุนู ุนูู ุชุณุฌูู ุงูุฏุฎูู ุฅูู ุญุณุงุจ Hugging Face ุงูุฎุงุต ุจู ุญุชู ุชุชููู ูู ุชุญููู ูููุฐุฌู ููุดุงุฑูุชู ูุน ุงููุฌุชูุน. ุนูุฏูุง ููุทูุจ ููู ุฐููุ ุฃุฏุฎู ุฑูุฒู ูููุตูู:

```py
>>> from huggingface_hub import notebook_login

>>> notebook_login()
```

## ุชุญููู ูุฌููุนุฉ ุจูุงูุงุช IMDb

ุงุจุฏุฃ ุจุชุญููู ูุฌููุนุฉ ุจูุงูุงุช IMDb ูู ููุชุจุฉ Datasets ๐ค:

```py
>>> from datasets import load_dataset

>>> imdb = load_dataset("imdb")
```

ุซู ุงูู ูุธุฑุฉ ุนูู ูุซุงู:

```py
>>> imdb["test"][0]
{
"label": 0,
"text": "ุฃูุง ุฃุญุจ ุงูุฎูุงู ุงูุนููู ูุฃูุง ุนูู ุงุณุชุนุฏุงุฏ ูุชุญูู ุงููุซูุฑ. ุฃููุงู/ุชููุฒููู ุงูุฎูุงู ุงูุนููู ุนุงุฏุฉ ูุง ุชููู ููููุฉ ููุงูุตุฉ ุงูุชูุฏูุฑ ููููููุฉ. ุญุงููุช ุฃู ุฃุญุจ ูุฐุงุ ุญุงููุช ุญููุงุ ููููุง ุจุงููุณุจุฉ ูุชููุฒููู ุงูุฎูุงู ุงูุนููู ุงูุฌูุฏ ูุซู ุจุงุจู 5 ุฅูู ุณุชุงุฑ ุชุฑูู (ุงูุฃุตูู). ุฃุฏูุงุช ุชุฌููู ุณุฎููุฉุ ูุฌููุนุงุช ูู ุงููุฑู ุงููููู ุงูุฑุฎูุตุ ุญูุงุฑุงุช ูุชุนุฑุฌุฉุ ุฑุณููุงุช ุงูููุจููุชุฑ ุงูุชู ูุง ุชุชุทุงุจู ูุน ุงูุฎูููุฉุ ูุดุฎุตูุงุช ุฃุญุงุฏูุฉ ุงูุฃุจุนุงุฏ ูุคููุฉ ูุง ูููู ุงูุชุบูุจ ุนูููุง ูุน ุฅุนุฏุงุฏ "ุงูุฎูุงู ุงูุนููู". (ุฃูุง ูุชุฃูุฏ ูู ุฃู ููุงู ูููู ููุงู ูู ูุนุชูุฏ ุฃู ุจุงุจู 5 ูู ุชููุฒููู ุงูุฎูุงู ุงูุนููู ุงูุฌูุฏ. ููุณ ูุฐูู. ุฅูู ูุจุชุฐู ูุบูุฑ ูููู.) ูู ุญูู ุฃู ุงููุดุงูุฏูู ุงูุฃูุฑููููู ูุฏ ูุญุจูู ุงูุนุงุทูุฉ ูุชุทููุฑ ุงูุดุฎุตูุฉุ ูุฅู ุงูุฎูุงู ุงูุนููู ูู ููุน ูุง ูุฃุฎุฐ ููุณู ุนูู ูุญูู ุงูุฌุฏ (ุฑุงุฌุน ุณุชุงุฑ ุชุฑูู). ูุฏ ูุนุงูุฌ ูุถุงูุง ูููุฉุ ูููู ููุณ ูููุณูุฉ ุฌุงุฏุฉ. ูู ุงูุตุนุจ ุญููุง ุงูุงูุชูุงู ุจุงูุดุฎุตูุงุช ููุง ูุฃููุง ููุณุช ุณุฎููุฉ ูุญุณุจุ ุจู ุชูุชูุฑ ุฅูู ุดุฑุงุฑุฉ ุงูุญูุงุฉ. ุฃูุนุงููู ูุฑุฏูุฏ ุฃูุนุงููู ุฎุดุจูุฉ ููููู ุงูุชูุจุค ุจูุงุ ูุบุงูุจูุง ูุง ุชููู ูุคููุฉ ูููุดุงูุฏุฉ. ูุนุฑู ุตุงูุนู ุงูุฃุฑุถ ุฃููุง ููุงูุฉ ูุฃู ุนูููู ุฏุงุฆููุง ุฃู ูููููุง "ุฃุฑุถ ุฌูู ุฑูุฏุฏููุจูุฑู..." ูุฅูุง ููู ูุณุชูุฑ ุงููุงุณ ูู ุงููุดุงูุฏุฉ. ูุฌุจ ุฃู ุชููู ุฑูุงุฏ ุฑูุฏุฏููุจูุฑู ุชุฏูุฑ ูู ูุฏุงุฑูุง ุญูุซ ูุชุฎุจุท ูุฐุง ุงูุนุฑุถ ุงูุจุงูุช ุงูุฑุฎูุต ุณูุฆ ุงูุชุญุฑูุฑ (ูุดุงูุฏุชู ุฏูู ููุงุตู ุฅุนูุงููุฉ ูุฌูุจ ูุฐุง ุงูููุฒู) ุชุฑุงุจุงูุช ูุชุซุงูู ุฅูู ุงููุถุงุก. ุญุฑู. ูุฐููุ ุงูุชู ุดุฎุตูุฉ ุฑุฆูุณูุฉ. ุซู ุฃุนุฏู ูููุซู ุขุฎุฑ. ุฌูุฒ! ุฏุงูุงุณ ูุฑุฉ ุฃุฎุฑู.
```

ููุงู ุญููุงู ูู ูุฐู ุงููุฌููุนุฉ ูู ุงูุจูุงูุงุช:

- `text`: ูุต ูุฑุงุฌุนุฉ ุงููููู.
- `label`: ูููุฉ ุฅูุง `0` ููุฑุงุฌุนุฉ ุณูุจูุฉ ุฃู `1` ููุฑุงุฌุนุฉ ุฅูุฌุงุจูุฉ.

## ูุนุงูุฌุฉ ูุณุจูุฉ

ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุชุญููู ูุนุงูุฌ ูุตูุต DistilBERT ููุนุงูุฌุฉ ุญูู `ุงููุต`:

```py
>>> from transformers import AutoTokenizer

>>> tokenizer = AutoTokenizer.from_pretrained("distilbert/distilbert-base-uncased")
```

ูู ุจุฅูุดุงุก ุฏุงูุฉ ูุนุงูุฌุฉ ูุณุจูุฉ ูุชููููุฒ ุงููุต ูุชูููุต ุงูุชุณูุณูุงุช ุจุญูุซ ูุง ุชููู ุฃุทูู ูู ุงูุทูู ุงูุฃูุตู ููุฅุฏุฎุงู ูู DistilBERT:

```py
>>> def preprocess_function(examples):
...     return tokenizer(examples["text"], truncation=True)
```

ูุชุทุจูู ุฏุงูุฉ ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุฃููููุงุ ุงุณุชุฎุฏู ูุธููุฉ [`~datasets.Dataset.map`] ูู ููุชุจุฉ ๐ค Datasets. ููููู ุชุณุฑูุน `map` ุนู ุทุฑูู ุชุนููู `batched=True` ููุนุงูุฌุฉ ุนูุงุตุฑ ูุชุนุฏุฏุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูู ููุช ูุงุญุฏ:

```py
tokenized_imdb = imdb.map(preprocess_function, batched=True)
```

ุงูุขู ูู ุจุฅูุดุงุก ุฏูุนุฉ ูู ุงูุฃูุซูุฉ ุจุงุณุชุฎุฏุงู [`DataCollatorWithPadding`]. ูู ุงูุฃูุซุฑ ููุงุกุฉ ุฃู ุชููู *ุจุงูุชุญุฏูุฏ ุงูุฏููุงูููู* ููุฌูู ุฅูู ุงูุทูู ุงูุฃุทูู ูู ุฏูุนุฉ ุฃุซูุงุก ุงูุชุฌููุนุ ุจุฏูุงู ูู ุชุญุฏูุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุฃููููุง ุฅูู ุงูุทูู ุงูุฃูุตู.

<frameworkcontent>
<pt>
```py
>>> from transformers import DataCollatorWithPadding

>>> data_collator = DataCollatorWithPadding(tokenizer=tokenizer)
```
</pt>
<tf>
```py
>>> from transformers import DataCollatorWithPadding

>>> data_collator = DataCollatorWithPadding(tokenizer=tokenizer, return_tensors="tf")
```
</tf>
</frameworkcontent>

## ุชูููู

ุบุงูุจูุง ูุง ูููู ุชุถููู ูููุงุณ ุฃุซูุงุก ุงูุชุฏุฑูุจ ูููุฏูุง ูุชูููู ุฃุฏุงุก ูููุฐุฌู. ููููู ุชุญููู ุทุฑููุฉ ุชูููู ุจุณุฑุนุฉ ุจุงุณุชุฎุฏุงู ููุชุจุฉ ๐ค [Evaluate](https://huggingface.co/docs/evaluate/index). ุจุงููุณุจุฉ ููุฐู ุงููููุฉุ ูู ุจุชุญููู ูููุงุณ [ุงูุฏูุฉ](https://huggingface.co/spaces/evaluate-metric/accuracy) (ุฑุงุฌุน ุฌููุฉ ๐ค Evaluate [ุงูุณุฑูุนุฉ](https://huggingface.co/docs/evaluate/a_quick_tour) ููุนุฑูุฉ ุงููุฒูุฏ ุญูู ููููุฉ ุชุญููู ูุญุณุงุจ ูููุงุณ):

```py
>>> import evaluate

>>> accuracy = evaluate.load("accuracy")
```

ุซู ูู ุจุฅูุดุงุก ุฏุงูุฉ ุชูุฑุฑ ุชูุจุคุงุชู ูุชุณููุงุชู ุฅูู [`~evaluate.EvaluationModule.compute`] ูุญุณุงุจ ุงูุฏูุฉ:

```py
>>> import numpy as np


>>> def compute_metrics(eval_pred):
...     predictions, labels = eval_pred
...     predictions = np.argmax(predictions, axis=1)
...     return accuracy.compute(predictions=predictions, references=labels)
```

ุฏุงูุชู `compute_metrics` ุฌุงูุฒุฉ ุงูุขูุ ูุณุชุนูุฏ ุฅูููุง ุนูุฏูุง ุชููู ุจุฅุนุฏุงุฏ ุชุฏุฑูุจู.
ุจุงูุชุฃููุฏุ ุณุฃุชุจุน ุชุนูููุงุชู ูุณุฃููู ุจุชุฑุฌูุฉ ุงููุต ุงูููุฌูุฏ ูู ุงูููุฑุงุช ูุงูุนูุงููู ููุทุ ูุน ุชุฌุงูู ุงููุตูุต ุงูุจุฑูุฌูุฉ ูุงูุฑูุงุจุท ูุฃููุงุฏ HTML ูCSS.

## ุงูุชุฏุฑูุจ

ูุจู ุงูุจุฏุก ูู ุชุฏุฑูุจ ูููุฐุฌูุ ูู ุจุฅูุดุงุก ุฎุฑูุทุฉ ูููููุงุช ุงููุชููุนุฉ ุฅูู ุชุณููุงุชูุง ุงูุชูุถูุญูุฉ ุจุงุณุชุฎุฏุงู `id2label` ู`label2id`:

ุจุนุฏ ุฐููุ ุฃูุช ูุณุชุนุฏ ูุจุฏุก ุชุฏุฑูุจ ูููุฐุฌู! ูู ุจุชุญููู DistilBERT ูุน [`AutoModelForSequenceClassification`] ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุนุฏุฏ ุงูุชุณููุงุช ุงููุชููุนุฉุ ูุฎุฑุงุฆุท ุงูุชุณููุงุช:

ูู ูุฐู ุงููุฑุญูุฉุ ูู ูุชุจู ุณูู ุซูุงุซ ุฎุทูุงุช:

1. ูู ุจุชุนุฑูู ูุฑุท ูุนููุงุช ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจู ูู [`TrainingArguments`]. ุงููุนููุฉ ุงููุทููุจุฉ ุงููุญูุฏุฉ ูู `output_dir` ุงูุชู ุชุญุฏุฏ ููุงู ุญูุธ ูููุฐุฌู. ุณูู ุชููู ุจุฏูุน ูุฐุง ุงููููุฐุฌ ุฅูู Hub ุนู ุทุฑูู ุชุนููู `push_to_hub=True` (ูุฌุจ ุฃู ุชููู ูุณุฌูุงู ุงูุฏุฎูู ูู Hugging Face ูุชุญููู ูููุฐุฌู). ูู ููุงูุฉ ูู ุญูุจุฉุ ุณูููู [`Trainer`] ุจุชูููู ุงูุฏูุฉ ูุญูุธ ููุทุฉ ุชูุชูุด ุงูุชุฏุฑูุจ.

2. ูู ุจุชูุฑูุฑ ุงูุญุฌุฌ ุงูุชุฏุฑูุจูุฉ ุฅูู [`Trainer`] ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุงููููุฐุฌ ููุฌููุนุฉ ุงูุจูุงูุงุช ููุนููู ุงูุฑููุฒ ูููู ุชุฌููุน ุงูุจูุงูุงุช ููุธููุฉ `compute_metrics`.

3. ุงุชุตู ุจู [`~Trainer.train`] ูุถุจุท ูููุฐุฌู.

<Tip>

ูุทุจู [`Trainer`] ุงูุชุฏุจูุณ ุงูุฏููุงูููู ุจุดูู ุงูุชุฑุงุถู ุนูุฏ ุชูุฑูุฑ `tokenizer` ุฅููู. ูู ูุฐู ุงูุญุงูุฉุ ูุง ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ููู ุชุฌููุน ุงูุจูุงูุงุช ุจุดูู ุตุฑูุญ.

</Tip>

ุจูุฌุฑุฏ ุงูุชูุงู ุงูุชุฏุฑูุจุ ุดุงุฑู ูููุฐุฌู ูู Hub ุจุงุณุชุฎุฏุงู ุทุฑููุฉ [`~transformers.Trainer.push_to_hub`] ุญุชู ูุชููู ุงูุฌููุน ูู ุงุณุชุฎุฏุงู ูููุฐุฌู:

<Tip>

ููุญุตูู ุนูู ูุซุงู ุฃูุซุฑ ุชุนูููุง ุญูู ููููุฉ ุถุจุท ูููุฐุฌ ููุชุตููู ุงููุตูุ ุฑุงุฌุน ุงูุฏูุชุฑ ุงูููุงุณุจ
[ุฏูุชุฑ ููุงุญุธุงุช PyTorch](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/text_classification.ipynb)
ุฃู [ุฏูุชุฑ TensorFlow](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/text_classification-tf.ipynb).

</Tip>

## ุงูุงุณุชูุชุงุฌ

ุฑุงุฆุนุ ุงูุขู ุจุนุฏ ุฃู ุถุจุทุช ูููุฐุฌูุงุ ููููู ุงุณุชุฎุฏุงูู ููุงุณุชูุชุงุฌ!

ุงุญุตู ุนูู ุจุนุถ ุงููุตูุต ุงูุชู ุชุฑุบุจ ูู ุชุดุบูู ุงูุงุณุชุฏูุงู ุนูููุง:

ุฃุจุณุท ุทุฑููุฉ ูุชุฌุฑุจุฉ ูููุฐุฌู ุงููุถุจูุท ููุงุณุชุฏูุงู ูู ุงุณุชุฎุฏุงูู ูู [`pipeline`]. ูู ุจุชูููุฐ ุนูููุฉ ููุฑูุฉ ูุชุญููู ุงููุดุงุนุฑ ุจุงุณุชุฎุฏุงู ูููุฐุฌูุ ููุฑุฑ ูุตู ุฅููู:

ููููู ุฃูุถูุง ูุฏูููุง ุชูุฑุงุฑ ูุชุงุฆุฌ `pipeline` ุฅุฐุง ุฃุฑุฏุช:

ูู ุจุชููููุฒ ุงููุต ูุฅุฑุฌุงุน ุชูุณููุงุช PyTorch:

ูุฑุฑ ุงููุฏุฎูุงุช ุฅูู ุงููููุฐุฌ ูุฅุฑุฌุงุน `logits`:

ุงุญุตู ุนูู ุงููุฆุฉ ุฐุงุช ุงูุงุญุชูุงููุฉ ุงูุฃุนููุ ูุงุณุชุฎุฏู ุชุนููู `id2label` ูููููุฐุฌ ูุชุญูููู ุฅูู ุชุณููุฉ ูุตูุฉ:

ูู ุจุชููููุฒ ุงููุต ูุฅุฑุฌุงุน ุชูุณููุงุช TensorFlow:

ูุฑุฑ ุงููุฏุฎูุงุช ุฅูู ุงููููุฐุฌ ูุฅุฑุฌุงุน `logits`:

ุงุญุตู ุนูู ุงููุฆุฉ ุฐุงุช ุงูุงุญุชูุงููุฉ ุงูุฃุนููุ ูุงุณุชุฎุฏู ุชุนููู `id2label` ูููููุฐุฌ ูุชุญูููู ุฅูู ุชุณููุฉ ูุตูุฉ: