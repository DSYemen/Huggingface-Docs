# ุงุณุชุฑุงุชูุฌูุงุช ุชูููุฏ ุงููุต

ูุนุฏ ุชูููุฏ ุงููุต ุฃุณุงุณููุง ูู ุงูุนุฏูุฏ ูู ููุงู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉุ ูุซู ุชูููุฏ ุงููุต ุงูููุชูุญุ ูุงูุชูุฎูุตุ ูุงูุชุฑุฌูุฉุ ูุฃูุซุฑ ูู ุฐูู. ููุง ุฃูู ููุนุจ ุฏูุฑูุง ูู ูุฌููุนุฉ ูุชููุนุฉ ูู ุชุทุจููุงุช ุงูุทุฑุงุฆู ุงููุฎุชูุทุฉ ุงูุชู ูููู ุงููุต ูู ูุงุชุฌูุง ูุซู ุชุญููู ุงูููุงู ุฅูู ูุตุ ูุงูุตูุฑ ุฅูู ูุต. ุจุนุถ ุงูููุงุฐุฌ ุงูุชู ูููููุง ุชูููุฏ ุงููุต ุชุดูู: GPT2ุ XLNetุ OpenAI GPTุ CTRLุ TransformerXLุ XLMุ Bartุ T5ุ GITุ Whisper.

ุงุทูุน ุนูู ุจุนุถ ุงูุฃูุซูุฉ ุงูุชู ุชุณุชุฎุฏู ุทุฑููุฉ [~generation.GenerationMixin.generate] ูุฅูุชุงุฌ ุงููุตูุต ูููุงู ูุฎุชููุฉ:

- [ุชูุฎูุต ุงููุต](./tasks/summarization#inference)
- [ูุถุน ุนููุงู ููุตูุฑุฉ](./model_doc/git#transformers.GitForCausalLM.forward.example)
- [ูุณุฎ ุงูุตูุช](./model_doc/whisper#transformers.WhisperForConditionalGeneration.forward.example)

ูุงุญุธ ุฃู ุงููุฏุฎูุงุช ุฅูู ุทุฑููุฉ ุงูุชูููุฏ ุชุนุชูุฏ ุนูู ุทุฑููุฉ ุงููููุฐุฌ. ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ูุฆุฉ ูุนุงูุฌุฉ ุงููููุฐุฌุ ูุซู AutoTokenizer ุฃู AutoProcessor. ุฅุฐุง ุฃูุดุฃุช ูุนุงูุฌุฉ ุงููููุฐุฌ ุฃูุซุฑ ูู ููุน ูุงุญุฏ ูู ุงูุฅุฏุฎุงูุ ููู ุจุชูุฑูุฑ ุฌููุน ุงูุฅุฏุฎุงูุงุช ุฅูู generate(). ููููู ูุนุฑูุฉ ุงููุฒูุฏ ุญูู ูุนุงูุฌุฉ ุงูููุงุฐุฌ ุงููุฑุฏูุฉ ูู ูุซุงุฆู ุงููููุฐุฌ ุงูููุงุจูุฉ.

ุชูุนุฑู ุนูููุฉ ุงุฎุชูุงุฑ ุงูุฑููุฒ ุงููููุฒุฉ ููุฅุฎุฑุงุฌ ูุชูููุฏ ุงููุต ุจุงุณู ูู ุงูุชุดููุฑุ ูููููู ุชุฎุตูุต ุฅุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ุงูุชู ุณุชุณุชุฎุฏููุง ุทุฑููุฉ `generate()`. ูุง ูุคุฏู ุชุนุฏูู ุฅุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ุฅูู ุชุบููุฑ ููู ุฃู ูุนููุงุช ูุงุจูุฉ ููุชุฏุฑูุจ. ููุน ุฐููุ ูููู ุฃู ูููู ูู ุชุฃุซูุฑ ููุญูุธ ุนูู ุฌูุฏุฉ ุงูุฅุฎุฑุงุฌ ุงููููุฏ. ูููู ุฃู ูุณุงุนุฏ ูู ุชูููู ุงูุชูุฑุงุฑ ูู ุงููุต ูุฌุนูู ุฃูุซุฑ ุชูุงุณููุง.

ูุตู ูุฐุง ุงูุฏููู ูุง ููู:

- ุชูููู ุงูุชูููุฏ ุงูุงูุชุฑุงุถู
- ุงุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ุงูุดุงุฆุนุฉ ููุนููุงุชูุง ุงูุฑุฆูุณูุฉ
- ุญูุธ ููุดุงุฑูุฉ ุชููููุงุช ุงูุชูููุฏ ุงููุฎุตุตุฉ ูุน ูููุฐุฌ ุงูุชุฏุฑูุจ ุงูุฏููู ุงูุฎุงุต ุจู ุนูู ๐ค Hub

#  ุชูููู ุงูุชูููุฏ ุงูุงูุชุฑุงุถู

ุชุชู ุชุนุฑูู ุฅุณุชุฑุงุชูุฌูุฉ ูู ุชุดููุฑ ุงููููุฐุฌ ูู ุชูููู ุงูุชูููุฏ ุงูุฎุงุต ุจู. ุนูุฏ ุงุณุชุฎุฏุงู ุงูููุงุฐุฌ ุงููุฏุฑุจุฉ ูุณุจููุง ููุงุณุชูุชุงุฌ ุฏุงุฎู [`pipeline`]ุ ุชููู ุงูููุงุฐุฌ ุจุงุณุชุฏุนุงุก ุทุฑููุฉ `PreTrainedModel.generate()` ุงูุชู ุชุทุจู ุชูููู ุงูุชูููุฏ ุงูุงูุชุฑุงุถู ุชุญุช ุงูุบุทุงุก. ูุชู ุฃูุถูุง ุงุณุชุฎุฏุงู ุงูุชูููู ุงูุงูุชุฑุงุถู ุนูุฏูุง ูุง ูุชู ุญูุธ ุฃู ุชูููู ูุฎุตุต ูุน ุงููููุฐุฌ.

ุนูุฏูุง ุชููู ุจุชุญููู ูููุฐุฌ ุจุดูู ุตุฑูุญุ ููููู ูุญุต ุชูููู ุงูุชูููุฏ ุงูุฐู ูุฃุชู ูุนู ูู ุฎูุงู `model.generation_config`:

```python
>>> from transformers import AutoModelForCausalLM

>>> model = AutoModelForCausalLM.from_pretrained("distilbert/distilgpt2")
>>> model.generation_config
GenerationConfig {
"bos_token_id": 50256,
"eos_token_id": 50256
}
```

ููุดู ุทุจุงุนุฉ `model.generation_config` ููุท ุนู ุงูููู ุงูุชู ุชุฎุชูู ุนู ุชูููู ุงูุชูููุฏ ุงูุงูุชุฑุงุถูุ ููุง ูุฏุฑุฌ ุฃููุง ูู ุงูููู ุงูุงูุชุฑุงุถูุฉ.

ููุชุตุฑ ุชูููู ุงูุชูููุฏ ุงูุงูุชุฑุงุถู ุนูู ุญุฌู ุงูุฅุฎุฑุงุฌ ุงููุฏูุฌ ูุน ููุฌู ุงูุฅุฏุฎุงู ุจุญุฏ ุฃูุตู 20 ุฑูุฒูุง ูุชุฌูุจ ููุงุฌูุฉ ูููุฏ ุงูููุงุฑุฏ. ุฅุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ุงูุงูุชุฑุงุถูุฉ ูู ุงูุจุญุซ ุงูุฌุดุนุ ูุงูุชู ุชุนุฏ ุฃุจุณุท ุฅุณุชุฑุงุชูุฌูุฉ ูู ุชุดููุฑ ุชุฎุชุงุฑ ุฑูุฒูุง ูููุฒูุง ูู ุฃุนูู ุงุญุชูุงู ุจุงุนุชุจุงุฑู ุงูุฑูุฒ ุงููููุฒ ุงูุชุงูู. ุจุงููุณุจุฉ ููุนุฏูุฏ ูู ุงูููุงู ูุฃุญุฌุงู ุงูุฅุฎุฑุงุฌ ุงูุตุบูุฑุฉุ ูุนูู ูุฐุง ุจุดูู ุฌูุฏ. ููุน ุฐููุ ุนูุฏูุง ูุชู ุงุณุชุฎุฏุงูู ูุชูููุฏ ูุฎุฑุฌุงุช ุฃุทููุ ูููู ุฃู ูุจุฏุฃ ุงูุจุญุซ ุงูุฌุดุน ูู ุฅูุชุงุฌ ูุชุงุฆุฌ ูุชูุฑุฑุฉ ููุบุงูุฉ.

## ุชุฎุตูุต ุชูููุฏ ุงููุต

ููููู ุชุฌุงูุฒ ุฃู `generation_config` ุนู ุทุฑูู ุชูุฑูุฑ ุงููุนููุงุช ูููููุง ูุจุงุดุฑุฉู ุฅูู ุทุฑููุฉ [`generate`]:

```python
>>> my_model.generate(**inputs, num_beams=4, do_sample=True)  # doctest: +SKIP
```

ุญุชู ุฅุฐุง ูุงูุช ุฅุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ุงูุงูุชุฑุงุถูุฉ ุชุนูู ุจุดูู ุฃุณุงุณู ููููุชูุ ููุง ูุฒุงู ุจุฅููุงูู ุถุจุท ุจุนุถ ุงูุฃุดูุงุก. ุจุนุถ ุงููุนููุงุช ุงูุชู ูุชู ุถุจุทูุง ุจุดูู ุดุงุฆุน ุชุดูู ูุง ููู:

- `max_new_tokens`: ุงูุนุฏุฏ ุงูุฃูุตู ููุฑููุฒ ุงููููุฒุฉ ุงูุชู ุณูุชู ุชูููุฏูุง. ูุจุนุจุงุฑุฉ ุฃุฎุฑูุ ุญุฌู ุชุณูุณู ุงูุฅุฎุฑุงุฌุ ุจุงุณุชุซูุงุก ุงูุฑููุฒ ุงููููุฒุฉ ุงูููุฌูุฏุฉ ูู ุงูููุฌู. ูุจุฏูู ูุงุณุชุฎุฏุงู ุทูู ุงูุฅุฎุฑุงุฌ ููุนูุงุฑ ุฅููุงูุ ููููู ุงุฎุชูุงุฑ ุฅููุงู ุงูุชูููุฏ ูู ุฃู ููุช ูุชุฌุงูุฒ ููู ุงูุชูููุฏ ุงููุงูู ููุฏุงุฑูุง ูุนูููุง ูู ุงูููุช. ููุนุฑูุฉ ุงููุฒูุฏุ ุฑุงุฌุน [`StoppingCriteria`].
- `num_beams`: ูู ุฎูุงู ุชุญุฏูุฏ ุนุฏุฏ ุงูุญุฒู ุฃูุจุฑ ูู 1ุ ูุฃูุช ุชููู ุจุงูุชุจุฏูู ุจุดูู ูุนุงู ูู ุงูุจุญุซ ุงูุฌุดุน ุฅูู ุงูุจุญุซ ุงูุดุนุงุนู. ุชูููู ูุฐู ุงูุฅุณุชุฑุงุชูุฌูุฉ ุงูุนุฏูุฏ ูู ุงููุฑุถูุงุช ูู ูู ุฎุทูุฉ ุฒูููุฉ ูุชุฎุชุงุฑ ูู ุงูููุงูุฉ ุงููุฑุถูุฉ ุงูุชู ูููู ููุง ุฃุนูู ุงุญุชูุงู ุฅุฌูุงูู ููุชุณูุณู ุจุฃูููู. ุชุชูุซู ููุฒุฉ ูุฐู ุงูุฅุณุชุฑุงุชูุฌูุฉ ูู ุชุญุฏูุฏ ุชุณูุณูุงุช ุนุงููุฉ ุงูุงุญุชูุงู ุชุจุฏุฃ ุจุฑููุฒ ูููุฒุฉ ุฃูููุฉ ุฃูู ุงุญุชูุงููุง ูุงูุชู ุณุชุชุฌุงูููุง ุทุฑููุฉ ุงูุจุญุซ ุงูุฌุดุน. ูู ุจุชุตูุฑ ููููุฉ ุนูููุง [ููุง](https://huggingface.co/spaces/m-ric/beam_search_visualizer).
- `do_sample`: ุฅุฐุง ุชู ุชุนูููู ุนูู `True`ุ ูุฅู ูุฐู ุงููุนููุฉ ุชููู ุฅุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ูุซู ุงูุนููุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏุ ูุงูุจุญุซ ุงูุดุนุงุนู ูุชุนุฏุฏ ุงูุญุฏูุฏุ ูุงูุนููุงุช ุงูุฃุนูู Kุ ูุงูุนููุงุช ุงูุฃุนูู p. ุชููู ุฌููุน ูุฐู ุงูุฅุณุชุฑุงุชูุฌูุงุช ุจุชุญุฏูุฏ ุงูุฑูุฒ ุงููููุฒ ุงูุชุงูู ูู ุชูุฒูุน ุงูุงุญุชูุงููุฉ ุนุจุฑ ุงูููุฑุฏุงุช ุจุงููุงูู ูุน ุชุนุฏููุงุช ูุญุฏุฏุฉ ููุฅุณุชุฑุงุชูุฌูุฉ.
- `num_return_sequences`: ุนุฏุฏ ุชุณูุณูุงุช ุงููุฑุดุญูู ุงูุชู ุณูุชู ุฅุฑุฌุงุนูุง ููู ุฅุฏุฎุงู. ูุฐุง ุงูุฎูุงุฑ ูุชุงุญ ููุท ูุฅุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ุงูุชู ุชุฏุนู ุนุฏุฉ ุชุณูุณูุงุช ูุฑุดุญุฉุ ุนูู ุณุจูู ุงููุซุงูุ ุงุฎุชูุงูุงุช ุงูุจุญุซ ุงูุดุนุงุนู ูุงูููุฐุฌุฉ. ุชุนูุฏ ุฅุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ูุซู ุงูุจุญุซ ุงูุฌุดุน ูุงูุจุญุซ ุงูุชุจุงููู ุชุณูุณู ุฅุฎุฑุงุฌ ูุงุญุฏ.

## ุญูุธ ุฅุณุชุฑุงุชูุฌูุฉ ูู ุชุดููุฑ ูุฎุตุตุฉ ูุน ูููุฐุฌ

ุฅุฐุง ููุช ุชุฑุบุจ ูู ูุดุงุฑูุฉ ูููุฐุฌ ุงูุชุฏุฑูุจ ุงูุฏููู ูุน ุชูููู ุชูููุฏ ูุญุฏุฏุ ูููููู:

1. ุฅูุดุงุก ูุซูู ูุฆุฉ [`GenerationConfig`]
2. ุชุญุฏูุฏ ูุนููุงุช ุฅุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ
3. ุญูุธ ุชูููู ุงูุชูููุฏ ุงูุฎุงุต ุจู ุจุงุณุชุฎุฏุงู [`GenerationConfig.save_pretrained`]ุ ูุงูุชุฃูุฏ ูู ุชุฑู ุญุฌุชู `config_file_name` ูุงุฑุบุฉ
4. ูู ุจุชุนููู `push_to_hub` ุนูู `True` ูุชุญููู ุชููููู ุฅูู ูุณุชูุฏุน ุงููููุฐุฌ

```python
>>> from transformers import AutoModelForCausalLM, GenerationConfig

>>> model = AutoModelForCausalLM.from_pretrained("my_account/my_model")  # doctest: +SKIP
>>> generation_config = GenerationConfig(
...     max_new_tokens=50, do_sample=True, top_k=50, eos_token_id=model.config.eos_token_id
... )
>>> generation_config.save_pretrained("my_account/my_model", push_to_hub=True)  # doctest: +SKIP
```

ููููู ุฃูุถูุง ุชุฎุฒูู ุงูุนุฏูุฏ ูู ุชููููุงุช ุงูุชูููุฏ ูู ุฏููู ูุงุญุฏุ ุจุงุณุชุฎุฏุงู ุญุฌุฉ `config_file_name` ูู [`GenerationConfig.save_pretrained`]. ููููู ูุงุญููุง ุงุณุชุฏุนุงุก ูุซููุงุชูุง ุจุงุณุชุฎุฏุงู [`GenerationConfig.from_pretrained`]. ูุฐุง ูููุฏ ุฅุฐุง ููุช ุชุฑูุฏ ุชุฎุฒูู ุงูุนุฏูุฏ ูู ุชููููุงุช ุงูุชูููุฏ ููููุฐุฌ ูุงุญุฏ (ุนูู ุณุจูู ุงููุซุงูุ ูุงุญุฏ ูุชูููุฏ ูุต ุฅุจุฏุงุนู ุจุงูููุฐุฌุฉุ ูุขุฎุฑ ููุชูุฎูุต ุจุงูุจุญุซ ุงูุดุนุงุนู). ูุฌุจ ุฃู ูููู ูุฏูู ุงูุฃุฐููุงุช ุงูุตุญูุญุฉ ูู Hub ูุฅุถุงูุฉ ูููุงุช ุชูููู ุฅูู ูููุฐุฌ.

```python
>>> from transformers import AutoModelForSeq2SeqLM, AutoTokenizer, GenerationConfig

>>> tokenizer = AutoTokenizer.from_pretrained("google-t5/t5-small")
>>> model = AutoModelForSeq2SeqLM.from_pretrained("google-t5/t5-small")

>>> translation_generation_config = GenerationConfig(
...     num_beams=4,
...     early_stopping=True,
...     decoder_start_token_id=0,
...     eos_token_id=model.config.eos_token_id,
...     pad_token=model.config.pad_token_id,
... )

>>> # Tip: add `push_to_hub=True` to push to the Hub
>>> translation_generation_config.save_pretrained("/tmp", "translation_generation_config.json")

>>> # You could then use the named generation config file to parameterize generation
>>> generation_config = GenerationConfig.from_pretrained("/tmp", "translation_generation_config.json")
>>> inputs = tokenizer("translate English to French: Configuration files are easy to use!", return_tensors="pt")
>>> outputs = model.generate(**inputs, generation_config=generation_config)
>>> print(tokenizer.batch_decode(outputs, skip_special_tokens=True))
['Les fichiers de configuration sont faciles ร utiliser!']
```

## ุงูุจุซ

ุชุฏุนู ุทุฑููุฉ `generate()` ุงูุจุซุ ูู ุฎูุงู ุฅุฏุฎุงููุง `streamer`. ูุฏุฎูุงุช `streamer` ูุชูุงููุฉ ูุน ุฃู ูุซูู ูู ูุฆุฉ ุชุญุชูู ุนูู ุงูุทุฑู ุงูุชุงููุฉ: `put()` ู`end()`. ุฏุงุฎูููุงุ ูุชู ุงุณุชุฎุฏุงู `put()` ูุฏูุน ุงูุฑููุฒ ุงููููุฒุฉ ุงูุฌุฏูุฏุฉ ููุชู ุงุณุชุฎุฏุงู `end()` ููุฅุดุงุฑุฉ ุฅูู ููุงูุฉ ุชูููุฏ ุงููุต.

<Tip warning={true}>
ูุง ูุฒุงู API ููุฆุงุช ุงูุจุซ ููุฏ ุงูุชุทููุฑ ููุฏ ูุชุบูุฑ ูู ุงููุณุชูุจู.
</Tip>

ูู ุงููุงุญูุฉ ุงูุนูููุฉุ ููููู ุฅูุดุงุก ูุฆุฉ ุจุซ ูุฎุตุตุฉ ูุฌููุน ุฃููุงุน ุงูุฃุบุฑุงุถ! ูุฏููุง ุฃูุถูุง ูุฆุงุช ุจุซ ุฃุณุงุณูุฉ ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู. ุนูู ุณุจูู ุงููุซุงูุ ููููู ุงุณุชุฎุฏุงู ูุฆุฉ [`TextStreamer`] ูุจุซ ุฅุฎุฑุงุฌ `generate()` ุฅูู ุดุงุดุชูุ ูููุฉ ูุงุญุฏุฉ ูู ูู ูุฑุฉ:

```python
>>> from transformers import AutoModelForCausalLM, AutoTokenizer, TextStreamer

>>> tok = AutoTokenizer.from_pretrained("openai-community/gpt2")
>>> model = AutoModelForCausalLM.from_pretrained("openai-community/gpt2")
>>> inputs = tok(["An increasing sequence: one,"], return_tensors="pt")
>>> streamer = TextStreamer(tok)

>>> # Despite returning the usual output, the streamer will also print the generated text to stdout.
>>> _ = model.generate(**inputs, streamer=streamer, max_new_tokens=20)
An increasing sequence: one, two, three, four, five, six, seven, eight, nine, ten, eleven,
```
ุจุงูุชุฃููุฏุ ุณุฃููู ุจุชุฑุฌูุฉ ุงููุต ุงูููุฌูุฏ ูู ุงูููุฑุงุช ูุงูุนูุงููู ูุน ุงูุงูุชุฒุงู ุจุงูุชุนูููุงุช ุงูุชู ูุฏูุชูุง.

## ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุงุชูุญ ูุงูููู (KV Cache Quantization)
ุชุฏุนู ุทุฑููุฉ `generate()` ุชุฎุฒูู ุงูููุงุชูุญ ูุงูููู ุงููุคูุชุฉ ูุชุนุฒูุฒ ุงูููุงุกุฉ ูุชุฌูุจ ุฅุนุงุฏุฉ ุงูุญุณุงุจุงุช. ููุน ุฐููุ ูููู ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุงุชูุญ ูุงูููู ุฃู ุชุดุบู ุฌุฒุกูุง ูุจูุฑูุง ูู ุงูุฐุงูุฑุฉุ ููุง ูุตุจุญ ุนูู ุฒุฌุงุฌุฉ ูุชูููุฏ ุงูุณูุงูุงุช ุงูุทูููุฉุ ุฎุงุตุฉ ุจุงููุณุจุฉ ููููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ. ูููู ูุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุนูุฏ ุงุณุชุฎุฏุงู `generate()` ุฃู ูููู ุจุดูู ูุจูุฑ ูู ูุชุทูุจุงุช ุงูุฐุงูุฑุฉ ุนูู ุญุณุงุจ ุงูุณุฑุนุฉ.

ูุณุชููู ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุงุชูุญ ูุงูููู ูู ููุชุจุฉ "ุชุฑุงูุณููุฑูุฑุฒ" ุฅูู ุญุฏ ูุจูุฑ ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ [KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache] (KIVI: ุชูููู ุบูุฑ ูุชูุงุซู 2-ุจุช ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุงุชูุญ ูุงูููู ุฏูู ุงูุญุงุฌุฉ ุฅูู ุถุจุท). ูุชุฏุนู ุญุงูููุง "ููุงูุชู" (quanto) ู"HQQ" ูุฎูููุงุช. ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุขููุฉ ุงูุนูู ุงูุฏุงุฎููุฉุ ูุฑุฌู ุงูุฑุฌูุน ุฅูู ุงููุฑูุฉ ุงูุจุญุซูุฉ.

ูุชูููู ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุงุชูุญ ูุงููููุ ูุฌุจ ุงูุฅุดุงุฑุฉ ุฅูู `cache_implementation="quantized"` ูู `generation_config`. ูุฌุจ ุชูุฑูุฑ ุงูุญุฌุฌ ุงููุชุนููุฉ ุจุงูุชูููู ุฅูู `generation_config` ุฅูุง ููุงููุณ ุฃู ูุญุงูุฉ ููุฆุฉ [`QuantizedCacheConfig`]. ูุฌุจ ุนููู ุงูุฅุดุงุฑุฉ ุฅูู ุฎูููุฉ ุงูุชูููู ุงูุชู ุชุฑูุฏ ุงุณุชุฎุฏุงููุง ูู [`QuantizedCacheConfig`]ุ ูุงูุฎูููุฉ ุงูุงูุชุฑุงุถูุฉ ูู "ููุงูุชู".

<Tip warning={true}>
ูููู ุฃู ูููู ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุถุงุฑูุง ุฅุฐุง ูุงู ุทูู ุงูุณูุงู ูุตูุฑูุง ููุงูุช ููุงู ุฐุงูุฑุฉ ูุตูู ุนุดูุงุฆู GPU VRAM ูุงููุฉ ููุชุดุบูู ุจุฏูู ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.
</Tip>

## ุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉ (Watermarking)
ุชุฏุนู ุทุฑููุฉ `generate()` ุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉ ุฅูู ุงููุต ุงููููุฏ ุนู ุทุฑูู ูุถุน ุนูุงูุฉ ุนุดูุงุฆูุฉ ุนูู ุฌุฒุก ูู ุงูุฑููุฒ ูู "ุฎุถุฑุงุก". ุนูุฏูุง ูุชู ุชูููุฏ ุงููุตุ ูุชู ุฅุถุงูุฉ ูููุฉ "ุงูุญูุงุฒ" ุตุบูุฑุฉ ุฅูู ุงุญุชูุงูุงุช ุงูุฑููุฒ "ุงูุฎุถุฑุงุก"ุ ููุง ูุฒูุฏ ูู ุงุญุชูุงููุฉ ุชูููุฏูุง. ูููู ุงูุชุดุงู ุงููุต ุงูุฐู ูุญูู ุนูุงูุฉ ูุงุฆูุฉ ุนู ุทุฑูู ุญุณุงุจ ูุณุจุฉ ุงูุฑููุฒ "ุงูุฎุถุฑุงุก" ูู ุงููุต ูุชูุฏูุฑ ูุฏู ุงุญุชูุงููุฉ ุงูุญุตูู ุนูู ุชูู ุงููููุฉ ูู ุงูุฑููุฒ "ุงูุฎุถุฑุงุก" ูู ุงููุต ุงูุฐู ูููุฏู ุงูุฅูุณุงู. ุชู ุงูุชุฑุงุญ ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ ูุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉ ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ ["On the Reliability of Watermarks for Large Language Models"] (ุญูู ููุซูููุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉ ููููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ). ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุขููุฉ ุนูู ุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉุ ููุตู ุจุงูุฑุฌูุน ุฅูู ุงููุฑูุฉ ุงูุจุญุซูุฉ.

ูููู ุงุณุชุฎุฏุงู ุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉ ูุน ุฃู ูููุฐุฌ ุชูููุฏู ูู "ุชุฑุงูุณููุฑูุฑุฒ" ููุง ูุชุทูุจ ูููุฐุฌ ุชุตููู ุฅุถุงูููุง ูููุดู ุนู ุงููุต ุงูุฐู ูุญูู ุนูุงูุฉ ูุงุฆูุฉ. ูุชูุนูู ุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉุ ูู ุจุชูุฑูุฑ [`WatermarkingConfig`] ูุน ุงูุญุฌุฌ ุงููุงุฒูุฉ ูุจุงุดุฑุฉ ุฅูู ุทุฑููุฉ `.generate()` ุฃู ุฃุถููุง ุฅูู [`GenerationConfig`]. ูููู ูุงุญููุง ุงูุชุดุงู ุงููุต ุงูุฐู ูุญูู ุนูุงูุฉ ูุงุฆูุฉ ุจุงุณุชุฎุฏุงู [`WatermarkDetector`].

<Tip warning={true}>
ูุนุชูุฏ "ูุงุชุฑูุงุฑู ุฏูุชูุชูุฑ" (WatermarkDetector) ุฏุงุฎูููุง ุนูู ูุณุจุฉ ุงูุฑููุฒ "ุงูุฎุถุฑุงุก"ุ ููุง ุฅุฐุง ูุงู ุงููุต ุงููููุฏ ูุชุจุน ููุท ุงูุชูููู. ููุฐุง ุงูุณุจุจุ ููุตู ุจุฅุฒุงูุฉ ูุต ุงููุทุงูุจุฉ ุฅุฐุง ูุงู ุฃุทูู ุจูุซูุฑ ูู ุงููุต ุงููููุฏ. ูุฏ ูููู ููุฐุง ุฃูุถูุง ุชุฃุซูุฑ ุนูุฏูุง ูููู ุฃุญุฏ ุงูุชุณูุณูุงุช ูู ุงูุฏูุนุฉ ุฃุทููุ ููุง ูุชุณุจุจ ูู ุญุดู ุงูุตููู ุงูุฃุฎุฑู. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ูุฌุจ ุชููุฆุฉ ุงููุงุดู **ุจุงุณุชุฎุฏุงู ููุณ ุญุฌุฌ ุชูููู ุงูุนูุงูุฉ ุงููุงุฆูุฉ ุงููุณุชุฎุฏูุฉ ุฃุซูุงุก ุงูุชูููุฏ**.
</Tip>

ุฏุนููุง ูููุฏ ุจุนุถ ุงููุตูุต ูุน ุฅุถุงูุฉ ุงูุนูุงูุงุช ุงููุงุฆูุฉ. ูู ููุชุทู ุงูููุฏ ุฃุฏูุงูุ ูููู ุจุชุนููู ุงูุงูุญูุงุฒ ุฅูู 2.5 ููู ูููุฉ ุณูุชู ุฅุถุงูุชูุง ุฅูู ุงุญุชูุงูุงุช ุงูุฑููุฒ "ุงูุฎุถุฑุงุก". ุจุนุฏ ุชูููุฏ ุงููุต ุงูุฐู ูุญูู ุนูุงูุฉ ูุงุฆูุฉุ ูููููุง ุชูุฑูุฑู ูุจุงุดุฑุฉ ุฅูู `WatermarkDetector` ููุชุญูู ููุง ุฅุฐุง ูุงู ุงููุต ูููุฏูุง ุจูุงุณุทุฉ ุขูุฉ (ูุฎุฑุฌ ุงููููุฉ `True` ูููุต ุงููููุฏ ุจูุงุณุทุฉ ุขูุฉ ูุงููููุฉ `False` ูููุต ุงููููุฏ ุจูุงุณุทุฉ ุฅูุณุงู).

## ุงุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ (Decoding Strategies)
ูููู ุงุณุชุฎุฏุงู ูุฌููุนุงุช ูุนููุฉ ูู ูุนููุงุช ุทุฑููุฉ `generate()`ุ ููู ุงูููุงูุฉ `generation_config`ุ ูุชูููู ุงุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ุงููุญุฏุฏุฉ. ุฅุฐุง ููุช ุฌุฏูุฏูุง ุนูู ูุฐุง ุงููููููุ ููุตู ุจูุฑุงุกุฉ [ูุฐู ุงูุชุฏูููุฉ ุงูุชู ุชูุถุญ ููููุฉ ุนูู ุงุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ุงูุดุงุฆุนุฉ](https://huggingface.co/blog/how-to-generate).

ููุงุ ุณูุนุฑุถ ุจุนุถ ุงููุนููุงุช ุงูุชู ุชุชุญูู ูู ุงุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ูููุถุญ ููููุฉ ุงุณุชุฎุฏุงููุง.

### ุงูุจุญุซ ุงูุฌุดุน (Greedy Search)
ูุณุชุฎุฏู [`generate`] ุจุดูู ุงูุชุฑุงุถู ุงุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ุจุงูุจุญุซ ุงูุฌุดุนุ ูุฐูู ูุง ููุฒู ุชูุฑูุฑ ุฃู ูุนููุงุช ูุชูููููุง. ููุฐุง ูุนูู ุฃู ูุนููุฉ `num_beams` ูุถุจูุทุฉ ุนูู 1 ู`do_sample=False`.

### ุงูุจุญุซ ุงูุชุจุงููู (Contrastive Search)
ุชู ุงูุชุฑุงุญ ุงุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ุจุงูุจุญุซ ุงูุชุจุงููู ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ ูุนุงู 2022 ุจุนููุงู [A Contrastive Framework for Neural Text Generation] (ุฅุทุงุฑ ุชุจุงููู ูุชูููุฏ ุงููุต ุงูุนุตุจู). ููุฏ ุฃุธูุฑุช ูุชุงุฆุฌ ูุชูููุฉ ูุชูููุฏ ูุฎุฑุฌุงุช ุทูููุฉ ูุชูุงุณูุฉ ูุบูุฑ ูุชูุฑุฑุฉ. ููุนุฑูุฉ ููููุฉ ุนูู ุงูุจุญุซ ุงูุชุจุงูููุ ูุฑุฌู ุงูุงุทูุงุน ุนูู [ูุฐู ุงูุชุฏูููุฉ](https://huggingface.co/blog/introducing-csearch).

ุงููุนููุชุงู ุงูุฑุฆูุณูุชุงู ุงููุชุงู ุชูููุงู ูู ุงูุชุญูู ูู ุณููู ุงูุจุญุซ ุงูุชุจุงููู ููุง `penalty_alpha` ู`top_k`:

### ุฃุฎุฐ ุงูุนููุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ (Multinomial Sampling)
ุนูู ุนูุณ ุงูุจุญุซ ุงูุฌุดุน ุงูุฐู ูุฎุชุงุฑ ุฏุงุฆููุง ุงูุฑูุฒ ุฐู ุงูุงุญุชูุงููุฉ ุงูุฃุนูู ูุฑููุฒ ุงูุชุงููุ ูุฅู ุฃุฎุฐ ุงูุนููุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ (ุงููุนุฑูู ุฃูุถูุง ุจุงุณู ุฃุฎุฐ ุงูุนููุงุช ุงูุฃุณูุงูู) ูุฎุชุงุฑ ุงูุฑูุฒ ุงูุชุงูู ุจุดูู ุนุดูุงุฆู ุจูุงุกู ุนูู ุชูุฒูุน ุงูุงุญุชูุงููุฉ ุนูู ุงูููุฑุฏุงุช ุจุงููุงูู ุงูุชู ููุฏููุง ุงููููุฐุฌ. ูุญุธู ูู ุฑูุฒ ุจุงุญุชูุงููุฉ ุบูุฑ ุตูุฑูุฉ ุจูุฑุตุฉ ููุงุฎุชูุงุฑุ ููุง ูููู ูู ุฎุทุฑ ุงูุชูุฑุงุฑ.

ูุชูููู ุฃุฎุฐ ุงูุนููุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏุ ูู ุจุถุจุท `do_sample=True` ู`num_beams=1`.
### ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุนุงุนู
ุนูู ุนูุณ ุงูุจุญุซ ุงูุฌุดุนุ ูุญุชูุธ ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุนุงุนู ุจุนุฏุฉ ูุฑุถูุงุช ูู ูู ุฎุทูุฉ ุฒูููุฉ ููุฎุชุงุฑ ูู ุงูููุงูุฉ ุงููุฑุถูุฉ ุงูุชู ููุง ุฃุนูู ุงุญุชูุงู ุฅุฌูุงูู ููุชุณูุณู ุจุฃูููู. ุชุชูุซู ููุฒุฉ ุฐูู ูู ุชุญุฏูุฏ ุชุณูุณูุงุช ุนุงููุฉ ุงูุงุญุชูุงู ุชุจุฏุฃ ุจุฑููุฒ ุฃูููุฉ ุฃูู ุงุญุชูุงููุง ูุงูุชู ูุงู ูู ุงููููู ุชุฌุงูููุง ุจูุงุณุทุฉ ุงูุจุญุซ ุงูุฌุดุน.

ููููู ุชุตูุฑ ููููุฉ ุนูู ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุนุงุนู ูู [ูุฐุง ุงูุนุฑุถ ุงูุชูุถูุญู ุงูุชูุงุนูู](https://huggingface.co/spaces/m-ric/beam_search_visualizer): ุงูุชุจ ุฌููุชูุ ูุชูุงุนุจ ุจุงููุนููุงุช ููุดุงูุฏุฉ ููููุฉ ุชุบููุฑ ุฃุดุนุฉ ูู ุงูุชุดููุฑ.

ูุชูููู ุงุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ูุฐูุ ุญุฏุฏ `num_beams` (ุงููุนุฑูู ุฃูุถูุง ุจุงุณู ุนุฏุฏ ุงููุฑุถูุงุช ุงูุชู ูุฌุจ ุชุชุจุนูุง) ูุงูุชู ุชููู ุฃูุจุฑ ูู 1.

### ุงูุจุญุซ ุงูุดุนุงุนู ูุนููุงุช ูุชุนุฏุฏุฉ
ููุง ููุญู ุงูุงุณูุ ุชุฌูุน ุงุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ูุฐู ุจูู ุงูุจุญุซ ุงูุดุนุงุนู ูุงูุนููุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ. ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ `num_beams` ุฃูุจุฑ ูู 1ุ ูุชุนููู `do_sample=True` ูุงุณุชุฎุฏุงู ุงุณุชุฑุงุชูุฌูุฉ ูู ุงูุชุดููุฑ ูุฐู.

### ุงูุจุญุซ ุงูุดุนุงุนู ุงููุชููุน
ุงุณุชุฑุงุชูุฌูุฉ ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุนุงุนู ุงููุชููุน ูู ุงูุชุฏุงุฏ ูุงุณุชุฑุงุชูุฌูุฉ ุงูุจุญุซ ุงูุดุนุงุนู ุงูุชู ุชุชูุญ ุชูููุฏ ูุฌููุนุฉ ุฃูุซุฑ ุชููุนูุง ูู ุชุณูุณูุงุช ุงูุดุนุงุน ููุงุฎุชูุงุฑ ูู ุจูููุง. ููุนุฑูุฉ ููููุฉ ุนูููุงุ ุฑุงุฌุน [ุงูุจุญุซ ุงูุดุนุงุนู ุงููุชููุน: ูู ุชุดููุฑ ุงูุญููู ุงููุชููุนุฉ ูู ููุงุฐุฌ ุงูุชุณูุณู ุงูุนุตุจู](https://arxiv.org/pdf/1610.02424.pdf).

ูุฏู ูุฐุง ุงูููุฌ ุซูุงุซุฉ ูุนููุงุช ุฑุฆูุณูุฉ: `num_beams`ุ ู`num_beam_groups`ุ ู`diversity_penalty`.

ุชุถูู ุนููุจุฉ ุงูุชููุน ุชููุฒ ุงูุฅุฎุฑุงุฌ ุนุจุฑ ุงููุฌููุนุงุชุ ููุชู ุงุณุชุฎุฏุงู ุงูุจุญุซ ุงูุดุนุงุนู ุฏุงุฎู ูู ูุฌููุนุฉ.

### ูู ุงูุชุดููุฑ ุงูุชุฎูููู
ูู ุงูุชุดููุฑ ุงูุชุฎูููู (ุงููุนุฑูู ุฃูุถูุง ุจุงุณู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉ) ูู ุชุนุฏูู ูุงุณุชุฑุงุชูุฌูุงุช ูู ุงูุชุดููุฑ ุงููุฐููุฑุฉ ุฃุนูุงูุ ูุงูุชู ุชุณุชุฎุฏู ูููุฐุฌ ูุณุงุนุฏ (ููุถู ุฃู ูููู ุฃุตุบุฑ ุจูุซูุฑ) ุจููุณ ุจุฑูุงูุฌ ูู ุงูุชุดููุฑุ ูุชูููุฏ ุจุนุถ ุงูุฑููุฒ ุงููุฑุดุญุฉ. ุซู ูุชุญูู ุงููููุฐุฌ ุงูุฑุฆูุณู ูู ุงูุฑููุฒ ุงููุฑุดุญุฉ ูู ุชูุฑูุฑ ุฃูุงูู ูุงุญุฏุ ูุงูุฐู ูุณุฑุน ุนูููุฉ ูู ุงูุชุดููุฑ. ุฅุฐุง ูุงู `do_sample=True`ุ ูุณูุชู ุงุณุชุฎุฏุงู ุงูุชุญูู ูู ุงูุฑูุฒ ูุน ุฅุนุงุฏุฉ ุฃุฎุฐ ุงูุนููุงุช ุงูููุฏูุฉ ูู [ูุฑูุฉ ูู ุงูุชุดููุฑ ุงูุชุฎูููู](https://arxiv.org/pdf/2211.17192.pdf).

ุญุงูููุงุ ูุชู ุฏุนู ุงูุจุญุซ ุงูุฌุดุน ูุงูุนููุงุช ููุท ูุน ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉุ ููุง ูุฏุนู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉ ุงูุฅุฏุฎุงูุงุช ุงููุฌูุนุฉ.

ููุนุฑูุฉ ุงููุฒูุฏ ุญูู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉุ ุฑุงุฌุน [ููุดูุฑ ุงููุฏููุฉ ูุฐุง](https://huggingface.co/blog/assisted-generation).

ูุชูููู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉุ ูู ุจุชุนููู ูุณูุท `assistant_model` ุจูููุฐุฌ.

ุนูุฏ ุงุณุชุฎุฏุงู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉ ูุน ุทุฑู ุงูุนููุงุชุ ููููู ุงุณุชุฎุฏุงู ูุณูุท "ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ" ููุชุญูู ูู ุงูุนุดูุงุฆูุฉุ ุชูุงููุง ููุง ูู ุงูุญุงู ูู ุงูุนููุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ. ููุน ุฐููุ ูู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉุ ูุฏ ูุณุงุนุฏ ุชูููู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ุชุญุณูู ููุช ุงูุงุณุชุฌุงุจุฉ.

ุจุฏูุงู ูู ุฐููุ ููููู ุฃูุถูุง ุชุนููู `prompt_lookup_num_tokens` ูุชุดุบูู ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉ ุงููุงุฆู ุนูู n-gramุ ุนูู ุนูุณ ูู ุงูุชุดููุฑ ุจูุณุงุนุฏุฉ ุงููุงุฆู ุนูู ุงููููุฐุฌ. ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุนูู [ููุง](https://twitter.com/joao_gante/status/1747322413006643259).