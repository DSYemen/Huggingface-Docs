# ุชุญุณูู ุงูุงุณุชูุชุงุฌ ุจุงุณุชุฎุฏุงู LLM

ุฏูุนุช ุงูููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ ุชุทุจููุงุช ุชูููุฏ ุงููุตุ ูุซู ููุงุฐุฌ ุงูุฏุฑุฏุดุฉ ูุงุณุชููุงู ุงูููุฏุ ุฅูู ุงููุณุชูู ุงูุชุงูู ูู ุฎูุงู ุฅูุชุงุฌ ูุต ูุธูุฑ ูุณุชูู ุนุงูู ูู ุงูููู ูุงูุทูุงูุฉ. ูููู ูุง ูุฌุนู ูุฐู ุงูููุงุฐุฌ ุงููุบููุฉ ูููุฉ - ุฃู ุญุฌููุง - ูุทุฑุญ ุฃูุถูุง ุชุญุฏูุงุช ุฃูุงู ุงูุงุณุชูุชุงุฌ.

ุงูุงุณุชูุชุงุฌ ุงูุฃุณุงุณู ุจุทูุก ูุฃู ุงูููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ ูุฌุจ ุฃู ุชูุณุชุฏุนู ุจุดูู ูุชูุฑุฑ ูุชูููุฏ ุงูุฑูุฒ ุงูุชุงูู. ุชุชุฒุงูุฏ ุชุณูุณู ุงููุฏุฎูุงุช ูุน ุชูุฏู ุงูุชูููุฏุ ููุง ูุณุชุบุฑู ููุชูุง ุฃุทูู ูุฃุทูู ุจุงููุณุจุฉ ููููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ ููุนุงูุฌุฉ ุฐูู. ุชูุชูู ุงูููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ ุฃูุถูุง ูููุงุฑุงุช ุงููุนููุงุชุ ููุง ูุฌุนู ูู ุงูุตุนุจ ุชุฎุฒูู ุฌููุน ูุฐู ุงูุฃูุฒุงู ููุนุงูุฌุชูุง ูู ุงูุฐุงูุฑุฉ.

ุณููุถุญ ูุฐุง ุงูุฏููู ููููุฉ ุงุณุชุฎุฏุงู ุชูููุงุช ุงูุชุญุณูู ุงููุชุงุญุฉ ูู Transformers ูุชุณุฑูุน ุงูุงุณุชูุชุงุฌ ุจุงุณุชุฎุฏุงู ุงูููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ.

## ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุชุฉ kv-cache ู torch.compile

ุฃุซูุงุก ูู ุงูุชุดููุฑุ ุชุญุณุจ ุงูููุงุฐุฌ ุงููุบููุฉ ุงููุจูุฑุฉ ููู key-value (kv) ููู ุฑูุฒ ูู ุฑููุฒ ุงููุฏุฎูุงุชุ ูุจูุง ุฃููุง ููุงุฐุฌ ุชููุฏ ุงููุต ุจุดูู ุชููุงุฆูุ ูุฅููุง ุชุญุณุจ ููุณ ููู kv ูู ูู ูุฑุฉ ูุฃู ุงูุฅุฎุฑุงุฌ ุงููููุฏ ูุตุจุญ ุงูุขู ุฌุฒุกูุง ูู ุงููุฏุฎูุงุช. ูุฐุง ููุณ ูุนุงูุงู ููุบุงูุฉ ูุฃูู ุชููู ุจุฅุนุงุฏุฉ ุญุณุงุจ ููุณ ููู kv ูู ูู ูุฑุฉ.

ูุชุญุณูู ุฐููุ ููููู ุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช kv ูุชุฎุฒูู ุงูููุงุชูุญ ูุงูููู ุงูุณุงุจูุฉ ุจุฏูุงู ูู ุฅุนุงุฏุฉ ุญุณุงุจูุง ูู ูู ูุฑุฉ. ููุน ุฐููุ ูุธุฑูุง ูุฃู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช kv ุชููู ูุน ูู ุฎุทูุฉ ูู ุฎุทูุงุช ุงูุชูููุฏ ููู ุฏููุงููููุฉุ ูุฅููุง ุชููุนู ูู ุงูุงุณุชูุงุฏุฉ ูู torch.compileุ ููู ุฃุฏุงุฉ ุชุญุณูู ูููุฉ ุชููู ุจุฏูุฌ ููุฏ PyTorch ูู ููุงุฉ ุณุฑูุนุฉ ููุญุณูุฉ.

ุชูุญู ูุฐู ุงููุดููุฉ ุจุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุชุฉ *kv-cache* ูู ุฎูุงู ุชุฎุตูุต ุญุฌู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช kv ูุณุจููุง ุฅูู ูููุฉ ูุตููุ ููุง ูุชูุญ ูู ุฏูุฌูุง ูุน torch.compile ูููุตูู ุฅูู ุณุฑุนุฉ ุฃุนูู ุจููุฏุงุฑ 4 ูุฑุงุช.

ุจุงููุณุจุฉ ููุฐุง ุงููุซุงูุ ุฏุนูุง ูููู ุจุชุญููู ูููุฐุฌ Gemma.

ููุงู ุทุฑููุชุงู ููููู ูู ุฎูุงูููุง ุชูููู ุงููููุฐุฌ ูุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุชุฉ kv-cache. ุจุงููุณุจุฉ ููููุฐุฌ 7B ุนูู A100ุ ุชุญุตู ููุชุง ุงูุทุฑููุชุงู ุนูู ุชุณุฑูุน ุจููุฏุงุฑ 4 ูุฑุงุช ูู ุชูุฑูุฑ ุงูุฅุฑุณุงู. ูุฏ ูุฎุชูู ุชุณุฑูุนู ุงุนุชูุงุฏูุง ุนูู ุญุฌู ุงููููุฐุฌ (ุชุญุตู ุงูููุงุฐุฌ ุงูุฃูุจุฑ ุนูู ุชุณุฑูุน ุฃูู) ูุงูุฌูุงุฒ. ุฅุฐุง ููุช ุชุณุชุฎุฏู ุทุฑููุฉ `~GenerationMixin.generate`ุ ูุฅู ุงูุชุณุฑูุน ูุจูุบ ุญูุงูู 3 ูุฑุงุช. ุชูุฑูุฑ ุงูุฅุฑุณุงู (ุงูุฐู ูุง ูุฒุงู ูุญุตู ุนูู ุชุณุฑูุน 4 ูุฑุงุช) ูู ูุฌุฑุฏ ุฌุฒุก ูู ููุฏ ุทุฑููุฉ `GenerationMixin.generate` ุจุงููุงูู.

ููููู ุงููุตูู ุฅูู ุณูุฉ `generation_config` ูููููุฐุฌ ูุชุนููู `cache_implementation` ุฅูู "static".

ูู ุจุงูุงุณุชุฏุนุงุก `torch.compile` ุนูู ุงููููุฐุฌ ูุชุฌููุน ุชูุฑูุฑ ุงูุฅุฑุณุงู ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุชุฉ kv-cache.

ุชุญุช ุงูุบุทุงุกุ ุณูุญุงูู `generate` ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ููุณ ูุงุฆู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุชุ ููุง ูุฒูู ุงูุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุงูุชุฌููุน ูู ูู ุงุณุชุฏุนุงุก. ููุน ุฐููุ ุฅุฐุง ุฒุงุฏ ุญุฌู ุงูุฏูุนุฉ ุฃู ุทูู ุงูุฅุฎุฑุงุฌ ุงูุฃูุตู ุจูู ุงูุงุณุชุฏุนุงุกุงุชุ ูุณูุชุนูู ุฅุนุงุฏุฉ ุชููุฆุฉ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุชุ ููุง ูุคุฏู ุฅูู ุชุดุบูู ุนูููุฉ ุชุฌููุน ุฌุฏูุฏุฉ.

ูููู ุชูุฑูุฑ ูุงุฆู `StaticCache` ุฅูู ุชูุฑูุฑ ุงูุฅุฑุณุงู ูููููุฐุฌ ูู ุฅุทุงุฑ ูุณูุท `past_key_values`ุ ููุง ููููู ูู ุงุณุชุฎุฏุงู ูุฐุง ุงููุงุฆู ูุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช ุซุงุจุชุฉ kv-cache. ุจุงุณุชุฎุฏุงู ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉุ ููููู ูุชุงุจุฉ ุฏุงูุฉ ูู ุชุดููุฑ ุงูุฑูุฒ ุงูุชุงูู ุจุงููุธุฑ ุฅูู ุงูุฑูุฒ ุงูุญุงูู ูุงูููุถุน ูููุถุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุฑููุฒ ุงููููุฏุฉ ุณุงุจููุง. ููููู ุฃูุถูุง ุชูุฑูุฑ ูุงุฆู `StaticCache` ุฅูู ุทุฑููุฉ `GenerationMixin.generate` ูุงุณุชุฎุฏุงูู ุนุจุฑ ุงูุงุณุชุฏุนุงุกุงุชุ ุชูุงููุง ููุง ุชูุนู ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฏููุงููููุฉ.

ููุงู ุจุนุถ ุงูุฃุดูุงุก ุงููููุฉ ุงูุชู ูุฌุจ ุนููู ุงูููุงู ุจูุง ูุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุชุฉ kv-cache ู torch.compile ูุน ุทุฑููุฉ `StaticCache`:

1. ูู ุจุชููุฆุฉ ูุซูู `StaticCache` ูุจู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ููุงุณุชุฏูุงู. ููููู ููุง ุชูููู ุงููุนููุงุช ูุซู ุญุฌู ุงูุฏูุนุฉ ุงูุฃูุตู ูุทูู ุงูุชุณูุณู.

2. ูู ุจุงูุงุณุชุฏุนุงุก `torch.compile` ุนูู ุงููููุฐุฌ ูุชุฌููุน ุชูุฑูุฑ ุงูุฅุฑุณุงู ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุชุฉ kv-cache.

3. ูู ุจุชุนููู `enable_math=True` ูู ุณูุงู ูุฏูุฑ `torch.backends.cuda.sdp_kernel` ูุชูููู ุชูููุฐ C++ ุงูุฃุตูู ูู PyTorch ููุงูุชูุงู ุจุงูููุชุฌ ุงูููุทู ุงููููููููุฒ ูุชุณุฑูุน ุงูุงุณุชุฏูุงู ุจุดูู ุฃูุจุฑ.

ุณุชููู ุทุฑููุฉ `decode_one_tokens` ุจูู ุชุดููุฑ ุงูุฑูุฒ ุงูุชุงูู ุจุงููุธุฑ ุฅูู ุงูุฑูุฒ ุงูุญุงูู ูููุถุน ุงูุฅุฏุฎุงู ูููุถุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุฑููุฒ ุงููููุฏุฉ ุณุงุจููุง.

ุจุนุฏ ูู ุชุดููุฑ ุงูุฑูุฒ ุงูุชุงููุ ูููู ุจุชุญุฏูุซ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุถุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.

> [!TIP]
> ุฅุฐุง ููุช ุชุฑูุฏ ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ูุงุฆู `StaticCache` ูู ููุฌู ุฌุฏูุฏุ ูุชุฃูุฏ ูู ุฅุนุงุฏุฉ ุชุนููู ูุญุชููุงุชู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `.reset()`.
ุจุงูุชุฃููุฏุ ุณุฃุชุจุน ุชุนูููุงุชู ูุณุฃุชุฑุฌู ููุท ุงููุต ุงูููุฌูุฏ ูู ุงูููุฑุงุช ูุงูุนูุงูููุ ูุน ุชุฌุงูู ุงูุฃููุงุฏ ุงูุจุฑูุฌูุฉ ูุงูุฑูุงุจุท ูุฑููุฒ HTML ูCSS.

## ูู ุงูุชุดููุฑ ุงูุชุฎูููู

ุชุชูุซู ุฅุญุฏู ุงููุดููุงุช ุงูุฃุฎุฑู ูู ุงูุชูููุฏ ุงูุชููุงุฆู ูู ุฃูู ููู ุฑูุฒ ูู ุฑููุฒ ุงูุฅุฏุฎุงูุ ูุฌุจ ุชุญููู ุฃูุฒุงู ุงููููุฐุฌ ูู ูู ูุฑุฉ ุฃุซูุงุก ุงูุชูุฑูุฑ ููุฃูุงู. ููุฐุง ุจุทูุก ููุฑูู ุจุงููุณุจุฉ ูููุงุฐุฌ ุงููุบุฉ ุงูุถุฎูุฉ ุงูุชู ุชุญุชูู ุนูู ูููุงุฑุงุช ูู ุงููุนููุงุช. ููุฎูู ูู ุงูุชุดููุฑ ุงูุชุฎูููู ูู ูุฐุง ุงูุชุจุงุทุค ูู ุฎูุงู ุงุณุชุฎุฏุงู ูููุฐุฌ ูุณุงุนุฏ ุซุงู ุฃุตุบุฑ ูุฃุณุฑุน ูุชูููุฏ ุฑููุฒ ูุฑุดุญุฉ ูุชู ุงูุชุญูู ูููุง ุจูุงุณุทุฉ ูููุฐุฌ LLM ุงูุฃูุจุฑ ูู ุชูุฑูุฑุฉ ุชูุฌูู ูุงุญุฏุฉ. ุฅุฐุง ูุงูุช ุงูุฑููุฒ ุงููุชุญูู ูููุง ุตุญูุญุฉุ ูุญุตู LLM ุนูููุง ุจุดูู ุฃุณุงุณู "ูุฌุงููุง" ุฏูู ุงูุญุงุฌุฉ ุฅูู ุชูููุฏูุง ุจููุณู. ูุง ููุฌุฏ ุงูุฎูุงุถ ูู ุงูุฏูุฉ ูุฃู ุชูุฑูุฑุฉ ุงูุชุญูู ุฅูู ุงูุฃูุงู ุชุถูู ุชูููุฏ ููุณ ุงูุฅุฎุฑุงุฌ ููุง ูู ูุงู LLM ูุฏ ููุฏูุง ุจููุฑุฏู.

ูููุญุตูู ุนูู ุฃูุจุฑ ูุฏุฑ ูู ุงูุชุณุฑูุนุ ูุฌุจ ุฃู ูููู ุงููููุฐุฌ ุงููุณุงุนุฏ ุฃุตุบุฑ ุจูุซูุฑ ูู LLM ุจุญูุซ ููููู ุชูููุฏ ุงูุฑููุฒ ุจุณุฑุนุฉ. ูุฌุจ ุฃูุถูุง ุฃู ูุชุดุงุฑู ุงููููุฐุฌ ุงููุณุงุนุฏ ูLLM ูู ููุณ ุงููุญูู ุงูุฑูุฒู ูุชุฌูุจ ุฅุนุงุฏุฉ ุงูุชุฑููุฒ ููู ุชุฑููุฒ ุงูุฑููุฒ.

## ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุฑู

ูุชูููู ูู ุงูุชุดููุฑ ุงูุชุฎููููุ ูู ุจุชุญููู ูููุฐุฌ ูุณุงุนุฏ ููุฑุฑู ุฅูู ุทุฑููุฉ [`~GenerationMixin.generate`].

### ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุฑู

ูู ุชุดููุฑ ุงูุจุญุซ ุงูุดุฑู ูู ูุชุบูุฑ ูู ูู ุงูุชุดููุฑ ุงูุชุฎูููู ููู ุฃูุถูุง ูุชูุงูู ูุน ุงูุจุญุซ ุงูุดุฑู ูุงูููุฐุฌุฉ. ูุนูู ูู ุชุดููุฑ ุงููุทุงูุจุฉ ุจุดูู ุฌูุฏ ุจุดูู ุฎุงุต ููููุงุช ุงูุฅุฏุฎุงู ุงููุณุชูุฏุฉ - ูุซู ุงูููุฎุต - ุญูุซ ุบุงูุจูุง ูุง ุชููู ููุงู ูููุงุช ูุชุฏุงุฎูุฉ ุจูู ุงููุทุงูุจุฉ ูุงูุฅุฎุฑุงุฌ. ูุชู ุงุณุชุฎุฏุงู ูุฐู n-grams ุงููุชุฏุงุฎูุฉ ูุฑููุฒ ูุฑุดุญุฉ LLM.

ูุชูููู ูู ุชุดููุฑ ุงููุทุงูุจุฉุ ุญุฏุฏ ุนุฏุฏ ุงูุฑููุฒ ุงูุชู ูุฌุจ ุฃู ุชุชุฏุงุฎู ูู ูุนููุฉ `prompt_lookup_num_tokens`. ุจุนุฏ ุฐููุ ููููู ุชูุฑูุฑ ูุฐุง ุงููุนููุฉ ุฅูู ุทุฑููุฉ [`~GenerationMixin.generate`].

### ูู ุชุดููุฑ ุงูููุฐุฌุฉ

ููู ุชุดููุฑ ุงููุทุงูุจุฉ ูุน ุงูููุฐุฌุฉุ ุฃุถู ูุนููุงุช `do_sample` ู`temperature` ุฅูู ุทุฑููุฉ [`~GenerationMixin.generate`] ุจุงูุฅุถุงูุฉ ุฅูู ุงููููุฐุฌ ุงููุณุงุนุฏ.

## ุชุญุณูู ุงูุงูุชูุงู

ูู ุงููุนุฑูู ุฃู ูุดููุฉ ููุงุฐุฌ ุงููุญูู ูู ุฃู ุขููุฉ ุงูุงูุชูุงู ุงูุฐุงุชู ุชููู ุจุดูู ุชุฑุจูุนู ูู ุงูุญุณุงุจ ูุงูุฐุงูุฑุฉ ูุน ุนุฏุฏ ุฑููุฒ ุงูุฅุฏุฎุงู. ูุชู ุชุถุฎูู ูุฐุง ุงูููุฏ ููุท ูู ููุงุฐุฌ ุงููุบุฉ ุงูุถุฎูุฉ ุงูุชู ุชุชุนุงูู ูุน ุชุณูุณูุงุช ุฃุทูู. ููุนุงูุฌุฉ ูุฐุงุ ุฌุฑุจ FlashAttention2 ุฃู ุชูููุฐ PyTorch ููุงูุชูุงู ุจููุชุฌ ุงูููุงุท ุงููููููููุฒ (SDPA)ุ ูุงูุชู ุชุนุฏ ุนูููุงุช ุชูููุฐ ุฃูุซุฑ ููุงุกุฉ ูู ุงูุฐุงูุฑุฉ ููููููุง ุชุณุฑูุน ุงูุงุณุชุฏูุงู.

### FlashAttention-2

ููุณู FlashAttention ูFlashAttention-2 ุนูููุฉ ุญุณุงุจ ุงูุงูุชูุงู ุฅูู ุฃุฌุฒุงุก ุฃุตุบุฑ ููููู ูู ุนุฏุฏ ุนูููุงุช ุงููุฑุงุกุฉ/ุงููุชุงุจุฉ ุงููุณูุทุฉ ูู ุฐุงูุฑุฉ GPU ูุชุณุฑูุน ุงูุงุณุชุฏูุงู. ุชุชุญุณู FlashAttention-2 ูู ุฎูุงุฑุฒููุฉ FlashAttention ุงูุฃุตููุฉ ูู ุฎูุงู ุงูููุงุฒุงุฉ ุฃูุถูุง ุนุจุฑ ุจุนุฏ ุทูู ุงูุชุณูุณู ูุชูุณูู ุงูุนูู ุจุดูู ุฃูุถู ุนูู ุงูุฃุฌูุฒุฉ ูุชูููู ุงูุชูุงููู ุงูุนุงูุฉ ููุงุชุตุงู ูุงููุฒุงููุฉ.

ูุงุณุชุฎุฏุงู FlashAttention-2ุ ูู ุจุชุนููู `attn_implementation="flash_attention_2"` ูู ุทุฑููุฉ [`~PreTrainedModel.from_pretrained`].

### ุงูุชูุงู PyTorch ุจููุชุฌ ุงูููุงุท ุงููููููููุฒ

ูุชู ุชูููู ุงูุงูุชูุงู ุจููุชุฌ ุงูููุงุท ุงููููููููุฒ (SDPA) ุชููุงุฆููุง ูู PyTorch 2.0 ููู ูุฏุนู FlashAttention ูxFormers ูุชูููุฐ C++ ูู PyTorch. ุชุฎุชุงุฑ SDPA ุฎูุงุฑุฒููุฉ ุงูุงูุชูุงู ุงูุฃูุซุฑ ุฃุฏุงุกู ุฅุฐุง ููุช ุชุณุชุฎุฏู backend CUDA. ุจุงููุณุจุฉ ุฅูู backends ุงูุฃุฎุฑูุ ุชุณุชุฎุฏู SDPA ุจุดูู ุงูุชุฑุงุถู ุชูููุฐ C++ ูู PyTorch.

ููููู ุงุณุชุฎุฏุงู ูุฏูุฑ ุณูุงู [torch.backends.cuda.sdp_kernel](https://pytorch.org/docs/master/generated/torch.nn.functional.scaled_dot_product_attention.html) ูุชูููู ุฃู ุชุนุทูู ุฃู ูู ุฎูุงุฑุฒููุงุช ุงูุงูุชูุงู ุงูุซูุงุซุฉ ุจุดูู ุตุฑูุญ. ุนูู ุณุจูู ุงููุซุงูุ ูู ุจุชุนููู `enable_flash=True` ูุชูููู FlashAttention.

## ุงูุชูููู

ูููู ุงูุชูููู ูู ุญุฌู ุฃูุฒุงู LLM ุนู ุทุฑูู ุชุฎุฒูููุง ุจุฏูุฉ ุฃูู. ูุชุฑุฌู ูุฐุง ุฅูู ุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุฃูู ููุฌุนู ุชุญููู ููุงุฐุฌ ุงููุบุฉ ุงูุถุฎูุฉ ููุงุณุชุฏูุงู ุฃูุซุฑ ุณูููุฉ ุฅุฐุง ููุช ูููุฏูุง ุจุฐุงูุฑุฉ GPU ุงูุฎุงุตุฉ ุจู. ุฅุฐุง ูู ุชูู ูููุฏูุง ุจู GPU ุงูุฎุงุต ุจูุ ููุณุช ุจุญุงุฌุฉ ุฅูู ุชุญููู ูููุฐุฌู ุฅูู ุฃุฑูุงู ูุฃูู ูููู ุฃู ูุชูุจุฏ ุชูููุฉ ุตุบูุฑุฉ ูู ุงููููู (ุจุงุณุชุซูุงุก ูุญุฏุงุช AWQ ูAWQ ุงููุฏูุฌุฉ) ุจุณุจุจ ุงูุฎุทูุฉ ุงูุฅุถุงููุฉ ุงููุทููุจุฉ ูุชุญููู ุงูุฃูุฒุงู ูุฅูุบุงุก ุชุญููููุง.

ููุงู ุงูุนุฏูุฏ ูู ููุชุจุงุช ุงูุชูููู (ุฑุงุฌุน ุฏููู ุงูุชูููู ููุฒูุฏ ูู ุงูุชูุงุตูู) ุงููุชุงุญุฉุ ูุซู Quanto ูAQLM ูAWQ ูAutoGPTQ. ูุง ุชุชุฑุฏุฏ ูู ุชุฌุฑุจุชูุง ูุดุงูุฏ ุฃููุง ูุนูู ุจุดูู ุฃูุถู ูุญุงูุชู ุงูุงุณุชุฎุฏุงููุฉ. ููุตู ุฃูุถูุง ุจูุฑุงุกุฉ ููุดูุฑ ุงููุฏููุฉ ูุธุฑุฉ ุนุงูุฉ ุนูู ูุฎุทุทุงุช ุงูุชูููู ุงููุฏุนููุฉ ุจุดูู ุทุจูุนู ูู ๐ค ุงููุญููุงุช ูุงูุชู ุชูุงุฑู AutoGPTQ ูbitsandbytes.

ุงุณุชุฎุฏู ุขูุฉ ุญุงุณุจุฉ ุฐุงูุฑุฉ ุงููููุฐุฌ ุฃุฏูุงู ูุชูุฏูุฑ ูููุงุฑูุฉ ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุทููุจุฉ ูุชุญููู ูููุฐุฌ. ุนูู ุณุจูู ุงููุซุงูุ ุฌุฑุจ ุชูุฏูุฑ ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงูุชู ูุชููููุง ุชุญููู [Mistral-7B-v0.1](https://huggingface.co/mistralai/Mistral-7B-v0.1).

ูุชุญููู Mistral-7B-v0.1 ุจุฏูุฉ ูุตููุฉุ ูู ุจุชุนููู ูุนููุฉ `torch_dtype` ูู ุทุฑููุฉ [`~transformers.AutoModelForCausalLM.from_pretrained`] ุฅูู `torch.bfloat16`. ูุชุทูุจ ูุฐุง 13.74 ุฌูุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ.

ูุชุญููู ูููุฐุฌ ูููููููุฒ (8 ุจุชุงุช ุฃู 4 ุจุชุงุช) ููุงุณุชุฏูุงูุ ุฌุฑุจ [bitsandbytes](https://hf.co/docs/bitsandbytes) ููู ุจุชุนููู ูุนููุงุช `load_in_4bit` ุฃู `load_in_8bit` ุฅูู `True`. ูุชุทูุจ ุชุญููู ุงููููุฐุฌ ูู 8 ุจุชุงุช ููุท 6.87 ุฌูุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ.