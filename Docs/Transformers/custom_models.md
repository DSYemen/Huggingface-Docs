# ุจูุงุก ููุงุฐุฌ ูุฎุตุตุฉ

ุชู ุชุตููู ููุชุจุฉ ๐ค Transformers ูุชููู ูุงุจูุฉ ููุชูุณูุน ุจุณูููุฉ. ูู ูููุฐุฌ ููุดูุฑ ุจุงููุงูู ูู ูุฌูุฏ ูุฑุนู ูุนูู ูู ุงููุณุชูุฏุน ุฏูู ุฃู ุชุฌุฑูุฏุ ูุฐุง ููููู ุจุณูููุฉ ูุณุฎ ููู ุงูููุฐุฌุฉ ูุชุนุฏููู ููููุง ูุงุญุชูุงุฌุงุชู.

ุฅุฐุง ููุช ุชูุชุจ ูููุฐุฌูุง ุฌุฏูุฏูุง ุชูุงููุงุ ููุฏ ูููู ูู ุงูุฃุณูู ุงูุจุฏุก ูู ุงูุตูุฑ. ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนููููุ ุณููุฑููู ููููุฉ ูุชุงุจุฉ ูููุฐุฌ ูุฎุตุต ูุชููููู ุญุชู ูููู ุงุณุชุฎุฏุงูู ุฏุงุฎู Transformersุ ูููููุฉ ูุดุงุฑูุชู ูุน ุงููุฌุชูุน (ูุน ุงูููุฏ ุงูุฐู ูุนุชูุฏ ุนููู) ุจุญูุซ ูููู ูุฃู ุดุฎุต ุงุณุชุฎุฏุงููุ ุญุชู ุฅุฐุง ูู ููู ููุฌูุฏูุง ูู ููุชุจุฉ ๐ค Transformers. ุณูุฑู ููููุฉ ุงูุจูุงุก ุนูู ุงููุญููุงุช ูุชูุณูุน ุงูุฅุทุงุฑ ุจุงุณุชุฎุฏุงู hooks ูููุฏู ุงููุฎุตุต.

ุณูููู ุจุชูุถูุญ ูู ูุฐุง ุนูู ูููุฐุฌ ResNetุ ุนู ุทุฑูู ูู ูุฆุฉ ResNet ูู ููุชุจุฉ timm ูู [`PreTrainedModel`].

# ูุชุงุจุฉ ุชูููู ูุฎุตุต

ูุจู ุงูุบูุต ูู ุงููููุฐุฌุ ุฏุนููุง ููุชุจ ุฃููุงู ุชููููู. ุชูููู ุงููููุฐุฌ ูู ูุงุฆู ุณูุญุชูู ุนูู ุฌููุน ุงููุนูููุงุช ุงููุงุฒูุฉ ูุจูุงุก ุงููููุฐุฌ. ููุง ุณูุฑู ูู ุงููุณู ุงูุชุงููุ ูููู ูููููุฐุฌ ุฃู ูุฃุฎุฐ ููุท `config` ููุชู ุชููุฆุชูุ ูุฐุง ูุญุชุงุฌ ุญููุง ุฅูู ุฃู ูููู ูุฐุง ุงููุงุฆู ููุชูููุง ูุฏุฑ ุงูุฅููุงู.

ุชุชุจุน ุงูููุงุฐุฌ ูู ููุชุจุฉ `transformers` ููุณูุง ุจุดูู ุนุงู ุงูุงุชูุงููุฉ ุงูุชู ุชูุจู ูุงุฆู `config` ูู ุทุฑููุฉ `__init__` ุงูุฎุงุตุฉ ุจูุงุ ุซู ุชูุฑุฑ ูุงุฆู `config` ุจุงููุงูู ุฅูู ุงูุทุจูุงุช ุงููุฑุนูุฉ ูู ุงููููุฐุฌุ ุจุฏูุงู ูู ูุณุฑ ูุงุฆู ุงูุชูููู ุฅูู ุนุฏุฉ ุญุฌุฌ ูุชู ุชูุฑูุฑูุง ุฌููุนูุง ุจุดูู ูุฑุฏู ุฅูู ุงูุทุจูุงุช ุงููุฑุนูุฉ. ูุคุฏู ูุชุงุจุฉ ูููุฐุฌู ุจูุฐู ุงูุทุฑููุฉ ุฅูู ููุฏ ุฃุจุณุท ูุน "ูุตุฏุฑ ุญูููุฉ" ูุงุถุญ ูุฃู ูุฑุท ูุนููุงุชุ ููุง ูุณูู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูููุฏ ูู ุงูููุงุฐุฌ ุงูุฃุฎุฑู ูู `transformers`.

ูู ูุซุงููุงุ ุณูุฃุฎุฐ ุจุถุนุฉ ุญุฌุฌ ูู ูุฆุฉ ResNet ุงูุชู ูุฏ ูุฑุบุจ ูู ุถุจุทูุง. ุณุชุนุทููุง ุงูุชููููุงุช ุงููุฎุชููุฉ ุฃููุงุน ูุฎุชููุฉ ูู ุดุจูุงุช ResNet ุงูููููุฉ. ุซู ูููู ุจุจุณุงุทุฉ ุจุชุฎุฒูู ุชูู ุงูุญุฌุฌุ ุจุนุฏ ุงูุชุญูู ูู ุตุญุฉ ุจุนุถูุง.

```python
from transformers import PretrainedConfig
from typing import List

class ResnetConfig(PretrainedConfig):
    model_type = "resnet"

    def __init__(
        self,
        block_type="bottleneck",
        layers: List[int] = [3, 4, 6, 3],
        num_classes: int = 1000,
        input_channels: int = 3,
        cardinality: int = 1,
        base_width: int = 64,
        stem_width: int = 64,
        stem_type: str = "",
        avg_down: bool = False,
        **kwargs,
    ):
        if block_type not in ["basic", "bottleneck"]:
            raise ValueError(f"`block_type` must be 'basic' or bottleneck', got {block_type}.")
        if stem_type not in ["", "deep", "deep-tiered"]:
            raise ValueError(f"`stem_type` must be '', 'deep' or 'deep-tiered', got {stem_type}.")

        self.block_type = block_type
        self.layers = layers
        self.num_classes = num_classes
        self.input_channels = input_channels
        self.cardinality = cardinality
        self.base_width = base_width
        self.stem_width = stem_width
        self.stem_type = stem_type
        self.avg_down = avg_down
        super().__init__(**kwargs)
```

ุงูุฃุดูุงุก ุงูุซูุงุซุฉ ุงููููุฉ ุงูุชู ูุฌุจ ุชุฐูุฑูุง ุนูุฏ ูุชุงุจุฉ ุชููููู ุงูุฎุงุต ูู ูุง ููู:

- ูุฌุจ ุฃู ุชุฑุซ ูู `PretrainedConfig`ุ
- ูุฌุจ ุฃู ุชูุจู `__init__` ูู `PretrainedConfig` ุฃู kwargsุ
- ูุฌุจ ุชูุฑูุฑ ูุฐู `kwargs` ุฅูู `__init__` ููุทุจูุฉ ุงูุนููุง.

ูุถูู ุงูุฅุฑุซ ุญุตููู ุนูู ุฌููุน ุงููุธุงุฆู ูู ููุชุจุฉ ๐ค Transformersุ ูู ุญูู ุฃู ุงููููุฏ ุงูุฃุฎุฑู ุชุฃุชู ูู ุญูููุฉ ุฃู `PretrainedConfig` ูุฏูู ุงููุฒูุฏ ูู ุงูุญููู ุฃูุซุฑ ูู ุชูู ุงูุชู ุชููู ุจุชุนููููุง. ุนูุฏ ุฅุนุงุฏุฉ ุชุญููู ุชูููู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `from_pretrained`ุ ูุฌุจ ุฃู ููุจู ุชููููู ูุฐู ุงูุญููู ุซู ุฅุฑุณุงููุง ุฅูู ุงููุฆุฉ ุงูุนููุง.

ุชุญุฏูุฏ `model_type` ูุชููููู (ููุง `model_type="resnet"`) ููุณ ุฅูุฒุงูููุงุ ูุง ูู ุชุฑุบุจ ูู ุชุณุฌูู ูููุฐุฌู ุจุงุณุชุฎุฏุงู ุงููุฆุงุช ุงูุชููุงุฆูุฉ (ุฑุงุฌุน ุงููุณู ุงูุฃุฎูุฑ).

ูุน ุงูููุงู ุจุฐููุ ููููู ุจุณูููุฉ ุฅูุดุงุก ุชููููู ูุญูุธู ูุซููุง ุชูุนู ูุน ุฃู ุชูููู ูููุฐุฌ ุขุฎุฑ ูู ุงูููุชุจุฉ. ุฅููู ููููุฉ ุฅูุดุงุก ุชูููู resnet50d ูุญูุธู:

```py
resnet50d_config = ResnetConfig(block_type="bottleneck", stem_width=32, stem_type="deep", avg_down=True)
resnet50d_config.save_pretrained("custom-resnet")
```

ุณูุคุฏู ูุฐุง ุฅูู ุญูุธ ููู ุจุงุณู `config.json` ุฏุงุฎู ุงููุฌูุฏ `custom-resnet`. ุจุนุฏ ุฐููุ ููููู ุฅุนุงุฏุฉ ุชุญููู ุชููููู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `from_pretrained`:

```py
resnet50d_config = ResnetConfig.from_pretrained("custom-resnet")
```

ููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุฃู ุทุฑููุฉ ุฃุฎุฑู ูู ูุฆุฉ [`PretrainedConfig`]`ุ ูุซู [`~PretrainedConfig.push_to_hub`] ูุชุญููู ุชููููู ูุจุงุดุฑุฉ ุฅูู Hub.

# ูุชุงุจุฉ ูููุฐุฌ ูุฎุตุต

ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ุชูููู ResNetุ ูููููุง ุงููุชุงุจุนุฉ ููุชุงุจุฉ ุงููููุฐุฌ. ูู ุงููุงูุนุ ุณููุชุจ ูููุฐุฌูู: ุฃุญุฏููุง ูุณุชุฎุฑุฌ ุงูููุฒุงุช ุงููุฎููุฉ ูู ุฏูุนุฉ ูู ุงูุตูุฑ (ูุซู [`BertModel`]) ูุงูุขุฎุฑ ููุงุณุจ ูุชุตููู ุงูุตูุฑ (ูุซู [`BertForSequenceClassification`]).

ููุง ุฐูุฑูุง ุณุงุจููุงุ ุณูููู ููุท ุจูู ุงููููุฐุฌ ูุฅุจูุงุฆู ุจุณูุทูุง ูู ูุฐุง ุงููุซุงู. ุงูุดูุก ุงููุญูุฏ ุงูุฐู ูุญุชุงุฌ ุฅูู ูุนูู ูุจู ูุชุงุจุฉ ูุฐู ุงููุฆุฉ ูู ุฑุณู ุฎุฑูุทุฉ ุจูู ุฃููุงุน ุงููุชู ููุฆุงุช ุงููุชู ุงููุนููุฉ. ุจุนุฏ ุฐููุ ูุชู ุชุนุฑูู ุงููููุฐุฌ ูู ุงูุชูููู ุนู ุทุฑูู ุชูุฑูุฑ ูู ุดูุก ุฅูู ูุฆุฉ ResNet:

```py
from transformers import PreTrainedModel
from timm.models.resnet import BasicBlock, Bottleneck, ResNet
from .configuration_resnet import ResnetConfig

BLOCK_MAPPING = {"basic": BasicBlock, "bottleneck": Bottleneck}

class ResnetModel(PreTrainedModel):
    config_class = ResnetConfig

    def __init__(self, config):
        super().__init__(config)
        block_layer = BLOCK_MAPPING[config.block_type]
        self.model = ResNet(
            block_layer,
            config.layers,
            num_classes=config.num_classes,
            in_chans=config.input_channels,
            cardinality=config.cardinality,
            base_width=config.base_width,
            stem_width=config.stem_width,
            stem_type=config.stem_type,
            avg_down=config.avg_down,
        )

    def forward(self, tensor):
        return self.model.forward_features(tensor)
```

ุจุงููุณุจุฉ ูููููุฐุฌ ุงูุฐู ุณูุตูู ุงูุตูุฑุ ูุฅููุง ูุบูุฑ ููุท ุทุฑููุฉ forward:

```py
import torch

class ResnetModelForImageClassification(PreTrainedModel):
    config_class = ResnetConfig

    def __init__(self, config):
        super().__init__(config)
        block_layer = BLOCK_MAPPING[config.block_type]
        self.model = ResNet(
            block_layer,
            config.layers,
            num_classes=config.num_classes,
            in_chans=config.input_channels,
            cardinality=config.cardinality,
            base_width=config.base_width,
            stem_width=config.stem_width,
            stem_type=config.stem_type,
            avg_down=config.avg_down,
        )

    def forward(self, tensor, labels=None):
        logits = self.model(tensor)
        if labels is not None:
            loss = torch.nn.cross_entropy(logits, labels)
            return {"loss": loss, "logits": logits}
        return {"logits": logits}
```

ูู ููุชุง ุงูุญุงูุชููุ ูุงุญุธ ููู ูุฑุซ ูู `PreTrainedModel` ููุณุชุฏุนู ุชููุฆุฉ ุงููุฆุฉ ุงูุนููุง ุจุงุณุชุฎุฏุงู `config` (ูุซููุง ุชูุนู ุนูุฏ ูุชุงุจุฉ ูุญุฏุฉ `torch.nn.Module` ุนุงุฏูุฉ). ุงูุณุทุฑ ุงูุฐู ูุญุฏุฏ `config_class` ููุณ ุฅูุฒุงูููุงุ ูุง ูู ุชุฑุบุจ ูู ุชุณุฌูู ูููุฐุฌู ุจุงุณุชุฎุฏุงู ุงููุฆุงุช ุงูุชููุงุฆูุฉ (ุฑุงุฌุน ุงููุณู ุงูุฃุฎูุฑ).

ุฅุฐุง ูุงู ูููุฐุฌู ูุดุงุจููุง ุฌุฏูุง ููููุฐุฌ ููุฌูุฏ ุฏุงุฎู ุงูููุชุจุฉุ ูููููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ููุณ ุงูุชูููู ููุฐุง ุงููููุฐุฌ.

ูููู ููููุฐุฌู ุฃู ูุนูุฏ ุฃู ุดูุก ุชุฑูุฏูุ ูููู ุฅุนุงุฏุฉ ูุงููุณ ููุง ูุนููุง ูู `ResnetModelForImageClassification`ุ ูุน ุชุถููู ุงูุฎุณุงุฑุฉ ุนูุฏ ุชูุฑูุฑ ุงูุนูุงูุงุชุ ุณูุฌุนู ูููุฐุฌู ูุงุจููุง ููุงุณุชุฎุฏุงู ูุจุงุดุฑุฉ ุฏุงุฎู ูุฆุฉ [`Trainer`]. ูุนุฏ ุงุณุชุฎุฏุงู ุชูุณูู ุฅุฎุฑุงุฌ ุขุฎุฑ ุฃูุฑูุง ุฌูุฏูุง ุทุงููุง ุฃูู ุชุฎุทุท ูุงุณุชุฎุฏุงู ุญููุฉ ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจู ุฃู ููุชุจุฉ ุฃุฎุฑู ููุชุฏุฑูุจ.

ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ูุฆุฉ ุงููููุฐุฌุ ุฏุนูุง ููุดุฆ ูุงุญุฏุฉ:

```py
resnet50d = ResnetModelForImageClassification(resnet50d_config)
```

ููููู ุงุณุชุฎุฏุงู ุฃู ูู ุทุฑู [`PreTrainedModel`]`ุ ูุซู [`~PreTrainedModel.save_pretrained`] ุฃู [`~PreTrainedModel.push_to_hub`]. ุณูุณุชุฎุฏู ุงูุซุงูู ูู ุงููุณู ุงูุชุงููุ ูุณูุฑู ููููุฉ ุฏูุน ุฃูุฒุงู ุงููููุฐุฌ ูุน ููุฏ ูููุฐุฌูุง. ูููู ุฃููุงูุ ุฏุนูุง ูุญูู ุจุนุถ ุงูุฃูุฒุงู ุงูููุนููุฉ ูุณุจููุง ุฏุงุฎู ูููุฐุฌูุง.

ูู ุญุงูุชู ุงูุงุณุชุฎุฏุงููุฉ ุงูุฎุงุตุฉุ ุณุชููู ุนูู ุงูุฃุฑุฌุญ ุจุชุฏุฑูุจ ูููุฐุฌู ุงููุฎุตุต ุนูู ุจูุงูุงุชู ุงูุฎุงุตุฉ. ููุงูุชูุงู ุจุณุฑุนุฉ ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนููููุ ุณูุณุชุฎุฏู ุงูุฅุตุฏุงุฑ ุงูููุนูู ูุณุจููุง ูู resnet50d. ูุธุฑูุง ูุฃู ูููุฐุฌูุง ูู ูุฌุฑุฏ ุบูุงู ุญูููุ ููู ุงูุณูู ููู ูุฐู ุงูุฃูุฒุงู:

```py
import timm

pretrained_model = timm.create_model("resnet50d", pretrained=True)
resnet50d.model.load_state_dict(pretrained_model.state_dict())
```

ุงูุขู ุฏุนููุง ูุฑู ููู ูุชุฃูุฏ ูู ุฃูู ุนูุฏ ุงูููุงู ุจู [`~PreTrainedModel.save_pretrained`] ุฃู [`~PreTrainedModel.push_to_hub`]`ุ ูุชู ุญูุธ ููุฏ ุงููููุฐุฌ.
ุจุงูุชุฃููุฏ! ูููุง ููู ุชุฑุฌูุฉ ููุฌุฒุก ุงููุตู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู:

## ุชุณุฌูู ูููุฐุฌ ุจุฑูุฒ ูุฎุตุต ูููุฆุงุช ุงูุชููุงุฆูุฉ

ุฅุฐุง ููุช ุชูุชุจ ููุชุจุฉ ุชูุฏุฏ Hugging Face Transformersุ ููุฏ ุชุฑุบุจ ูู ุชูุฏูุฏ ุงููุฆุงุช ุงูุชููุงุฆูุฉ ูุชุดูู ูููุฐุฌู ุงูุฎุงุต. ูุฎุชูู ูุฐุง ุนู ุฏูุน ุงูุฑูุฒ ุฅูู ุงููุฑูุฒ ุจูุนูู ุฃู ุงููุณุชุฎุฏููู ุณูุญุชุงุฌูู ุฅูู ุงุณุชูุฑุงุฏ ููุชุจุชู ููุญุตูู ุนูู ุงูููุงุฐุฌ ุงููุฎุตุตุฉ (ุนูู ุนูุณ ุชูุฒูู ุฑูุฒ ุงููููุฐุฌ ุชููุงุฆููุง ูู ุงููุฑูุฒ).

ุทุงููุง ุฃู ุชููููู ูุญุชูู ุนูู ุณูุฉ "model_type" ุชุฎุชูู ุนู ุฃููุงุน ููุงุฐุฌ Hugging Face Transformers ุงูุญุงููุฉุ ูุฃู ูุฆุงุช ุงูููุงุฐุฌ ุงูุฎุงุตุฉ ุจู ูุฏููุง ุงูุตูุงุช "config_class" ุงูุตุญูุญุฉุ ููููู ุจุจุณุงุทุฉ ุฅุถุงูุชูุง ุฅูู ุงููุฆุงุช ุงูุชููุงุฆูุฉ ุนูู ุงููุญู ุงูุชุงูู:

ูุงุญุธ ุฃู ุงูุญุฌุฉ ุงูุฃููู ุงููุณุชุฎุฏูุฉ ุนูุฏ ุชุณุฌูู ุชููููู ุงููุฎุตุต ูู AutoConfig ูุฌุจ ุฃู ุชุชุทุงุจู ูุน "model_type" ูู ุชููููู ุงููุฎุตุตุ ูุงูุญุฌุฉ ุงูุฃููู ุงููุณุชุฎุฏูุฉ ุนูุฏ ุชุณุฌูู ููุงุฐุฌู ุงููุฎุตุตุฉ ูู ุฃู ูุฆุฉ ูููุฐุฌ ุชููุงุฆู ูุฌุจ ุฃู ุชุชุทุงุจู ูุน "config_class" ูุชูู ุงูููุงุฐุฌ.

## ุฅุฑุณุงู ุงูููุฏ ุฅูู ุงููุฑูุฒ

<Tip warning={true}>

ูุฐุง API ุชุฌุฑูุจู ููุฏ ูููู ุจู ุจุนุถ ุงูุชุบููุฑุงุช ุงูุทูููุฉ ูู ุงูุฅุตุฏุงุฑุงุช ุงููุงุฏูุฉ.

</Tip>

ุฃููุงูุ ุชุฃูุฏ ูู ุชุญุฏูุฏ ูููุฐุฌู ุจุงููุงูู ูู ููู .py. ูููู ุฃู ูุนุชูุฏ ุนูู ุงููุงุฑุฏุงุช ุงููุณุจูุฉ ูุจุนุถ ุงููููุงุช ุงูุฃุฎุฑู ุทุงููุง ุฃู ุฌููุน ุงููููุงุช ููุฌูุฏุฉ ูู ููุณ ุงูุฏููู (ูุง ูุฏุนู ุงููุญุฏุงุช ุงููุฑุนูุฉ ููุฐู ุงูููุฒุฉ ุญุชู ุงูุขู). ููุซุงููุงุ ุณูุญุฏุฏ ููููุง ูุณูู modeling_resnet.py ูููู configuration_resnet.py ูู ูุฌูุฏ ุฏููู ุงูุนูู ุงูุญุงูู ูุณูู resnet_model. ูุญุชูู ููู ุงูุชูููู ุนูู ุฑูุฒ ResnetConfig ูููู ุงูููุฐุฌุฉ ูุญุชูู ุนูู ุฑูุฒ ResnetModel ูResnetModelForImageClassification.

ูุญุชูู ููู __init__.py ุนูู ุฏุงูุฉ init ูุงุฑุบุฉุ ููู ููุฌูุฏ ููุท ุญุชู ูุชููู ุจุงูุซูู ูู ุงูุชุดุงู ุฃู resnet_model ูููู ุงุณุชุฎุฏุงูู ูููุฏููู.

<Tip warning={true}>

ุฅุฐุง ููุช ุชููู ุจูุณุฎ ูููุงุช ุงูููุฐุฌุฉ ูู ุงูููุชุจุฉุ ูุณูู ุชุญุชุงุฌ ุฅูู ุงุณุชุจุฏุงู ุฌููุน ุงููุงุฑุฏุงุช ุงููุณุจูุฉ ูู ุฃุนูู ุงูููู ูุงุณุชูุฑุงุฏูุง ูู ุญุฒูุฉ ุงููุญููุงุช.

</Tip>

ูุงุญุธ ุฃูู ููููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู (ุฃู ูุฆุฉ ูุฑุนูุฉ) ุชูููู/ูููุฐุฌ ููุฌูุฏ.

ููุดุงุฑูุฉ ูููุฐุฌู ูุน ุงููุฌุชูุนุ ุงุชุจุน ุงูุฎุทูุงุช ุงูุชุงููุฉ: ุฃููุงู ุงุณุชูุฑุฏ ูููุฐุฌ ResNet ูุงูุชูููู ูู ุงููููุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ุญุฏูุซูุง:

ุซู ุนููู ุฃู ุชุฎุจุฑ ุงูููุชุจุฉ ุฃูู ุชุฑูุฏ ูุณุฎ ูููุงุช ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุชูู ุงููุงุฆูุงุช ุนูุฏ ุงุณุชุฎุฏุงู ุทุฑููุฉ save_pretrained ูุชุณุฌูููุง ุจุดูู ุตุญูุญ ุจุงุณุชุฎุฏุงู ูุฆุฉ Auto ูุนููุฉ (ุฎุงุตุฉ ููููุงุฐุฌ)ุ ูู ุจุจุณุงุทุฉ ุจุชุดุบูู:

ูุงุญุธ ุฃูู ูุง ุชูุฌุฏ ุญุงุฌุฉ ูุชุญุฏูุฏ ูุฆุฉ ุชููุงุฆูุฉ ููุชูููู (ูููุงู ูุฆุฉ ุชููุงุฆูุฉ ูุงุญุฏุฉ ููุท ูููุ AutoConfig) ูููู ุงูุฃูุฑ ูุฎุชูู ุจุงููุณุจุฉ ููููุงุฐุฌ. ูุฏ ูููู ูููุฐุฌู ุงููุฎุตุต ููุงุณุจูุง ููุนุฏูุฏ ูู ุงูููุงู ุงููุฎุชููุฉุ ูุฐูู ูุฌุจ ุนููู ุชุญุฏูุฏ ุฃู ูู ุงููุฆุงุช ุงูุชููุงุฆูุฉ ูู ุงูุตุญูุญ ููููุฐุฌู.

<Tip>

ุงุณุชุฎุฏู register_for_auto_class() ุฅุฐุง ููุช ุชุฑูุฏ ูุณุฎ ูููุงุช ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. ุฅุฐุง ููุช ุชูุถู ุงุณุชุฎุฏุงู ุงูููุฏ ุงูููุฌูุฏ ุนูู ุงููุฑูุฒ ูู ูุณุชูุฏุน ุขุฎุฑุ ููุง ุชุญุชุงุฌ ุฅูู ุงุณุชุฏุนุงุฆู. ูู ุงูุญุงูุงุช ุงูุชู ููุฌุฏ ูููุง ุฃูุซุฑ ูู ูุฆุฉ ุชููุงุฆูุฉุ ููููู ุชุนุฏูู ููู config.json ูุจุงุดุฑุฉู ุจุงุณุชุฎุฏุงู ุงูุจููุฉ ุงูุชุงููุฉ:

</Tip>

ุงูุขูุ ุฏุนูุง ูููู ุจุฅูุดุงุก ุงูุชูููู ูุงูููุงุฐุฌ ููุง ูุนููุง ูู ูุจู:

ูุฅุฑุณุงู ุงููููุฐุฌ ุฅูู ุงููุฑูุฒุ ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู. ุฅูุง ุชุดุบูู ูู ุงููุญุทุฉ ุงูุทุฑููุฉ ุงูุฎุงุตุฉ ุจู:

ุฃู ูู ุฏูุชุฑ ููุงุญุธุงุช:

ููููู ุจุนุฏ ุฐูู ุงูุถุบุท ุนูู ูุณุงุญุฉ ุงูุงุณู ุงูุฎุงุตุฉ ุจู (ุฃู ููุธูุฉ ุฃูุช ุนุถู ูููุง) ุจูุฐู ุงูุทุฑููุฉ:

ุจุงูุฅุถุงูุฉ ุฅูู ุฃูุฒุงู ุงูููุฐุฌุฉ ูุงูุชูููู ุจุชูุณูู JSONุ ุชู ุฃูุถูุง ูุณุฎ ูููุงุช ุงูููุฐุฌุฉ ูุงูุชูููู .py ูู ูุฌูุฏ "custom-resnet50d" ูุชุญููู ุงููุชูุฌุฉ ุฅูู ุงููุฑูุฒ. ููููู ุงูุชุญูู ูู ุงููุชูุฌุฉ ูู ูุฐุง ูุณุชูุฏุน ุงููููุฐุฌ.

ุฑุงุฌุน ุชุนูููุงุช ุงููุดุงุฑูุฉ ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุทุฑููุฉ push ุฅูู Hub.

## ุงุณุชุฎุฏุงู ูููุฐุฌ ุจุฑูุฒ ูุฎุตุต

ููููู ุงุณุชุฎุฏุงู ุฃู ุชูููู ุฃู ูููุฐุฌ ุฃู ูุญุฏุฏ ููุงูุน ูุน ูููุงุช ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุฎุตุตุฉ ูู ูุณุชูุฏุนูุง ุจุงุณุชุฎุฏุงู ุงููุฆุงุช ุงูุชููุงุฆูุฉ ูุทุฑููุฉ from_pretrained. ูุชู ูุญุต ุฌููุน ุงููููุงุช ูุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ุชู ุชุญููููุง ุฅูู ุงููุฑูุฒ ุจุญุซูุง ุนู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ (ุฑุงุฌุน ูุซุงุฆู ุฃูุงู ุงููุฑูุฒ ููุฒูุฏ ูู ุงููุนูููุงุช)ุ ูููู ูุฌุจ ุนููู ูุฑุงุฌุนุฉ ุฑูุฒ ุงููููุฐุฌ ูุงููุคูู ูุชุฌูุจ ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุถุงุฑุฉ ุนูู ุฌูุงุฒู. ูู ุจุชุนููู trust_remote_code=True ูุงุณุชุฎุฏุงู ูููุฐุฌ ุจุฑูุฒ ูุฎุตุต:

ูู ุงููุณุชุญุณู ุจุดุฏุฉ ุฃูุถูุง ุชูุฑูุฑ ูุงุด ุงูุงูุชุฒุงู ููุฑุงุฌุนุฉ ููุชุฃูุฏ ูู ุฃู ูุคูู ุงูููุงุฐุฌ ูู ููู ุจุชุญุฏูุซ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุจุงุณุชุฎุฏุงู ุจุนุถ ุงูุฃุณุทุฑ ุงูุถุงุฑุฉ (ูุง ูู ุชุซู ุชูุงููุง ุจูุคููู ุงูููุงุฐุฌ).

ูุงุญุธ ุฃูู ุนูุฏ ุชุตูุญ ุชุงุฑูุฎ ุงูุงูุชุฒุงู ููุณุชูุฏุน ุงููููุฐุฌ ุนูู ุงููุฑูุฒุ ููุงู ุฒุฑ ููุณุฎ ูุงุด ุงูุงูุชุฒุงู ุจุณูููุฉ ูุฃู ุงูุชุฒุงู.