بالتأكيد، سأقوم بترجمة النص الموجود في الفقرات والعناوين فقط مع الحفاظ على تنسيق Markdown:

# استخراج خصائص الصور

تعد استخراج خصائص الصور مهمة لاستخراج ميزات ذات معنى دلالي معين من صورة معينة. ولهذه المهمة العديد من التطبيقات، بما في ذلك تشابه الصور واسترجاعها. علاوة على ذلك، يمكن استخدام معظم نماذج الرؤية الحاسوبية لاستخراج خصائص الصور، حيث يمكن إزالة الرأس المخصص للمهمة (تصنيف الصور، والكشف عن الأشياء، وما إلى ذلك) والحصول على الميزات. هذه الميزات مفيدة جدًا على مستوى أعلى: اكتشاف الحواف، واكتشاف الزوايا، وما إلى ذلك. وقد تحتوي أيضًا على معلومات حول العالم الحقيقي (على سبيل المثال، شكل القطة) اعتمادًا على مدى عمق النموذج. وبالتالي، يمكن استخدام هذه المخرجات لتدريب مصنفات جديدة على مجموعة بيانات محددة.

في هذا الدليل، سوف:

- تعلم كيفية بناء نظام تشابه صور بسيط يعتمد على خط أنابيب "استخراج ميزات الصور".
- إنجاز المهمة نفسها مع استدلال النموذج الأساسي.

## تشابه الصور باستخدام خط أنابيب "استخراج ميزات الصور"

لدينا صورتان لقطتين تجلسان على شباك صيد، إحداهما مُولدة.

دعونا نرى خط الأنابيب في العمل. أولاً، قم بتهيئة خط الأنابيب. إذا لم تقم بتمرير أي نموذج إليه، فسيتم تهيئة خط الأنابيب تلقائيًا باستخدام [google/vit-base-patch16-224](google/vit-base-patch16-224). إذا كنت ترغب في حساب التشابه، قم بتعيين "pool" على القيمة "True".

للاستنتاج باستخدام "pipe"، قم بتمرير كلتا الصورتين إليه.

يحتوي الإخراج على تضمين مجمع لهذه الصورتين.

لحساب درجة التشابه، نحتاج إلى تمريرها إلى دالة تشابه.

إذا كنت تريد الحصول على الحالات المخفية الأخيرة قبل التجميع، تجنب تمرير أي قيمة لمعلمة "pool" لأنها تكون مضبوطة بشكل افتراضي على القيمة "False". هذه الحالات المخفية مفيدة لتدريب مصنفات أو نماذج جديدة بناءً على الميزات من النموذج.

## الحصول على الميزات والتشابهات باستخدام "AutoModel"

يمكننا أيضًا استخدام فئة "AutoModel" في مكتبة "transformers" للحصول على الميزات. تقوم فئة "AutoModel" بتحميل أي نموذج من نماذج "transformers" بدون رأس مخصص لمهمة معينة، ويمكننا استخدام ذلك للحصول على الميزات.

دعونا نكتب دالة استدلال بسيطة. سنقوم بتمرير المدخلات أولاً إلى "processor" ثم تمرير مخرجاته إلى النموذج.

يمكننا تمرير الصور مباشرة إلى هذه الدالة والحصول على التضمينات.

يمكننا الحصول على التشابه مرة أخرى على التضمينات.