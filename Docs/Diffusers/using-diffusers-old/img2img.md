# ุงูุชุญููู ูู ุตูุฑุฉ ุฅูู ุตูุฑุฉ

[[open-in-colab]]

ุชุนุฏ ุนูููุฉ ุงูุชุญููู ูู ุตูุฑุฉ ุฅูู ุตูุฑุฉ ูุดุงุจูุฉ ูู [ุงููุต ุฅูู ุตูุฑุฉ](conditional_image_generation)ุ ูููู ุจุงูุฅุถุงูุฉ ุฅูู ููุฌูุ ููููู ุฃูุถูุง ุชูุฑูุฑ ุตูุฑุฉ ุฃูููุฉ ูููุทุฉ ุจุฏุงูุฉ ูุนูููุฉ ุงูุงูุชุดุงุฑ. ูุชู ุชุฑููุฒ ุงูุตูุฑุฉ ุงูุฃูููุฉ ุฅูู ูุณุงุญุฉ ุฎููุฉ ููุชู ุฅุถุงูุฉ ุถูุถุงุก ุฅูููุง. ุจุนุฏ ุฐููุ ูุฃุฎุฐ ูููุฐุฌ ุงูุงูุชุดุงุฑ ุงูุฎูู ููุฌู ูุงูุตูุฑุฉ ุงูุฎููุฉ ุงููุถุทุฑุจุฉุ ููุชููุน ุงูุถูุถุงุก ุงููุถุงูุฉุ ููุฒูู ุงูุถูุถุงุก ุงููุชููุนุฉ ูู ุงูุตูุฑุฉ ุงูุฃูููุฉ ุงูุฎููุฉ ููุญุตูู ุนูู ุงูุตูุฑุฉ ุงูุฎููุฉ ุงูุฌุฏูุฏุฉ. ูุฃุฎูุฑูุงุ ูููู ูู ุงูุชุฑููุฒ ุจุชุฑุฌูุฉ ุงูุตูุฑุฉ ุงูุฎููุฉ ุงูุฌุฏูุฏุฉ ูุฑุฉ ุฃุฎุฑู ุฅูู ุตูุฑุฉ.

ูุน ๐ค Diffusersุ ูููู ุงูุฃูุฑ ุณููุงู ูุซู 1-2-3:

1. ูู ุจุชุญููู ููุทุฉ ุชูุชูุด ูู ูุฆุฉ [`AutoPipelineForImage2Image`]ุ ูููู ูุฐุง ุงูุฃูุจูุจ ุชููุงุฆููุง ุจุชุนููู ุชุญููู ูุฆุฉ ุงูุฃูุงุจูุจ ุงูุตุญูุญุฉ ุจูุงุกู ุนูู ููุทุฉ ุงูุชูุชูุด:

```py
import torch
from diffusers import AutoPipelineForImage2Image
from diffusers.utils import load_image, make_image_grid

pipeline = AutoPipelineForImage2Image.from_pretrained(
"kandinsky-community/kandinsky-2-2-decoder", torch_dtype=torch.float16, use_safetensors=True
)
pipeline.enable_model_cpu_offload()
# ุงุญุฐู ุงูุณุทุฑ ุงูุชุงูู ุฅุฐุง ูู ููู xFormers ูุซุจุชูุง ุฃู ุฅุฐุง ูุงู ูุฏูู PyTorch 2.0 ุฃู ุฃุนูู ูุซุจุชูุง
pipeline.enable_xformers_memory_efficient_attention()
```

<Tip>
ุณุชูุงุญุธ ุทูุงู ุงูุฏูููุ ุฃููุง ูุณุชุฎุฏู [`~DiffusionPipeline.enable_model_cpu_offload`] ู [`~DiffusionPipeline.enable_xformers_memory_efficient_attention`]ุ ูุชูููุฑ ุงูุฐุงูุฑุฉ ูุฒูุงุฏุฉ ุณุฑุนุฉ ุงูุงุณุชุฏูุงู. ุฅุฐุง ููุช ุชุณุชุฎุฏู PyTorch 2.0ุ ููุณุช ุจุญุงุฌุฉ ุฅูู ุงุณุชุฏุนุงุก [`~DiffusionPipeline.enable_xformers_memory_efficient_attention`] ุนูู ุฎุท ุฃูุงุจูุจู ูุฃูู ุณูููู ุจุงููุนู ุจุงุณุชุฎุฏุงู ุงูุชูุงู [scaled-dot product](../optimization/torch2.0#scaled-dot-product-attention) ุงูุฃุตูู ูู PyTorch 2.0.
</Tip>

2. ูู ุจุชุญููู ุตูุฑุฉ ูุชูุฑูุฑูุง ุฅูู ุฎุท ุงูุฃูุงุจูุจ:

```py
init_image = load_image("https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/cat.png")
```

3. ูู ุจุชูุฑูุฑ ููุฌู ูุตูุฑุฉ ุฅูู ุฎุท ุงูุฃูุงุจูุจ ูุฅูุดุงุก ุตูุฑุฉ:

```py
prompt = "cat wizard, gandalf, lord of the rings, detailed, fantasy, cute, adorable, Pixar, Disney, 8k"
image = pipeline(prompt, image=init_image).images[0]
make_image_grid([init_image, image], rows=1, cols=2)
```

<div class="flex gap-4">
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/cat.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงูุฃูููุฉ</figcaption>
</div>
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงููููุฏุฉ</figcaption>
</div>
</div>

## ุงูููุงุฐุฌ ุงูุดุงุฆุนุฉ

ุฃูุซุฑ ููุงุฐุฌ ุงูุชุญููู ูู ุตูุฑุฉ ุฅูู ุตูุฑุฉ ุดููุนูุง ูู [Stable Diffusion v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5)ุ ู [Stable Diffusion XL (SDXL)](https://huggingface.co/stabilityai/stable-diffusion-xl-base-1.0)ุ ู [Kandinsky 2.2](https://huggingface.co/kandinsky-community/kandinsky-2-2-decoder). ุชุฎุชูู ูุชุงุฆุฌ ููุงุฐุฌ Stable Diffusion ู Kandinsky ุจุณุจุจ ุงูุงุฎุชูุงูุงุช ูู ุจููุชูุง ูุนูููุฉ ุงูุชุฏุฑูุจุ ููููู ุฃู ุชุชููุน ุจุดูู ุนุงู ุฃู ููุชุฌ SDXL ุตูุฑูุง ุฐุงุช ุฌูุฏุฉ ุฃุนูู ูู Stable Diffusion v1.5. ุฏุนููุง ูููู ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ููููุฉ ุงุณุชุฎุฏุงู ูู ูู ูุฐู ุงูููุงุฐุฌ ูููุงุฑูุฉ ูุชุงุฆุฌูุง.

### Stable Diffusion v1.5

Stable Diffusion v1.5 ุนุจุงุฑุฉ ุนู ูููุฐุฌ ุงูุชุดุงุฑ ุฎูู ุชู ุชููุฆุชู ูู ููุทุฉ ุชูุชูุด ูุจูุฑุฉุ ูุชู ุถุจุท ุฏูุชู ุจุดูู ุฃูุจุฑ ูู 595 ุฃูู ุฎุทูุฉ ุนูู ุตูุฑ 512x512. ูุงุณุชุฎุฏุงู ูุฐุง ุงูุฃูุจูุจ ููุชุญููู ูู ุตูุฑุฉ ุฅูู ุตูุฑุฉุ ุณุชุญุชุงุฌ ุฅูู ุฅุนุฏุงุฏ ุตูุฑุฉ ุฃูููุฉ ูุชูุฑูุฑูุง ุฅูู ุฎุท ุงูุฃูุงุจูุจ. ุจุนุฏ ุฐููุ ููููู ุชูุฑูุฑ ููุฌู ูุงูุตูุฑุฉ ุฅูู ุฎุท ุงูุฃูุงุจูุจ ูุฅูุดุงุก ุตูุฑุฉ ุฌุฏูุฏุฉ:

```py
import torch
from diffusers import AutoPipelineForImage2Image
from diffusers.utils import make_image_grid, load_image

pipeline = AutoPipelineForImage2Image.from_pretrained(
"runwayml/stable-diffusion-v1-5", torch_dtype=torch.float16, variant="fp16", use_safetensors=True
)
pipeline.enable_model_cpu_offload()
# ุงุญุฐู ุงูุณุทุฑ ุงูุชุงูู ุฅุฐุง ูู ููู xFormers ูุซุจุชูุง ุฃู ุฅุฐุง ูุงู ูุฏูู PyTorch 2.0 ุฃู ุฃุนูู ูุซุจุชูุง
pipeline.enable_xformers_memory_efficient_attention()

# ุฅุนุฏุงุฏ ุงูุตูุฑุฉ
url = "https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-init.png"
init_image = load_image(url)

prompt = "Astronaut in a jungle, cold color palette, muted colors, detailed, 8k"

# ุชูุฑูุฑ ุงูููุฌู ูุงูุตูุฑุฉ ุฅูู ุฎุท ุงูุฃูุงุจูุจ
image = pipeline(prompt, image=init_image).images[0]
make_image_grid([init_image, image], rows=1, cols=2)
```

<div class="flex gap-4">
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-init.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงูุฃูููุฉ</figcaption>
</div>
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-sdv1.5.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงููููุฏุฉ</figcaption>
</div>
</div>

### Stable Diffusion XL (SDXL)

SDXL ูู ุฅุตุฏุงุฑ ุฃูุซุฑ ููุฉ ูู ูููุฐุฌ Stable Diffusion. ูุณุชุฎุฏู ูููุฐุฌูุง ุฃุณุงุณููุง ุฃูุจุฑุ ููููุฐุฌ ุชุญุณูู ุฅุถุงูู ูุฒูุงุฏุฉ ุฌูุฏุฉ ุฅุฎุฑุงุฌ ุงููููุฐุฌ ุงูุฃุณุงุณู. ุงูุฑุฃ ุฏููู [SDXL](sdxl) ููุญุตูู ุนูู ุดุฑุญ ุฃูุซุฑ ุชูุตููุงู ุญูู ููููุฉ ุงุณุชุฎุฏุงู ูุฐุง ุงููููุฐุฌุ ูุงูุชูููุงุช ุงูุฃุฎุฑู ุงูุชู ูุณุชุฎุฏููุง ูุฅูุชุงุฌ ุตูุฑ ุนุงููุฉ ุงูุฌูุฏุฉ.

```py
import torch
from diffusers import AutoPipelineForImage2Image
from diffusers.utils import make_image_grid, load_image

pipeline = AutoPipelineForImage2Image.from_pretrained(
"stabilityai/stable-diffusion-xl-refiner-1.0", torch_dtype=torch.float16, variant="fp16", use_safetensors=True
)
pipeline.enable_model_cpu_offload()
# ุงุญุฐู ุงูุณุทุฑ ุงูุชุงูู ุฅุฐุง ูู ููู xFormers ูุซุจุชูุง ุฃู ุฅุฐุง ูุงู ูุฏูู PyTorch 2.0 ุฃู ุฃุนูู ูุซุจุชูุง
pipeline.enable_xformers_memory_efficient_attention()

# ุฅุนุฏุงุฏ ุงูุตูุฑุฉ
url = "https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-sdxl-init.png"
init_image = load_image(url)

prompt = "Astronaut in a jungle, cold color palette, muted colors, detailed, 8k"

# ุชูุฑูุฑ ุงูููุฌู ูุงูุตูุฑุฉ ุฅูู ุฎุท ุงูุฃูุงุจูุจ
image = pipeline(prompt, image=init_image, strength=0.5).images[0]
make_image_grid([init_image, image], rows=1, cols=2)
```

<div class="flex gap-4">
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-sdxl-init.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงูุฃูููุฉ</figcaption>
</div>
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-sdxl.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงููููุฏุฉ</figcaption>
</div>
</div>

### Kandinsky 2.2

ูุฎุชูู ูููุฐุฌ Kandinsky ุนู ููุงุฐุฌ Stable Diffusion ูุฃูู ูุณุชุฎุฏู ูููุฐุฌูุง ุฃููููุง ููุตูุฑ ูุฅูุดุงุก ุชุฑููุฒุงุช ููุตูุฑ. ุชุณุงุนุฏ ุงูุชุฑููุฒุงุช ูู ุฅูุดุงุก ูุญุงุฐุงุฉ ุฃูุถู ุจูู ุงููุต ูุงูุตูุฑุ ููุง ูุณูุญ ููููุฐุฌ ุงูุงูุชุดุงุฑ ุงูุฎูู ุจุชูููุฏ ุตูุฑ ุฃูุถู.

ุฃุจุณุท ุทุฑููุฉ ูุงุณุชุฎุฏุงู Kandinsky 2.2 ูู:

```py
import torch
from diffusers import AutoPipelineForImage2Image
from diffusers.utils import make_image_grid, load_image

pipeline = AutoPipelineForImage2Image.from_pretrained(
"kandinsky-community/kandinsky-2-2-decoder", torch_dtype=torch.float16, use_safetensors=True
)
pipeline.enable_model_cpu_offload()
# ุงุญุฐู ุงูุณุทุฑ ุงูุชุงูู ุฅุฐุง ูู ููู xFormers ูุซุจุชูุง ุฃู ุฅุฐุง ูุงู ูุฏูู PyTorch 2.0 ุฃู ุฃุนูู ูุซุจุชูุง
pipeline.enable_xformers_memory_efficient_attention()

# ุฅุนุฏุงุฏ ุงูุตูุฑุฉ
url = "https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-init.png"
init_image = load_image(url)

prompt = "Astronaut in a jungle, cold color palette, muted colors, detailed, 8k"

# ุชูุฑูุฑ ุงูููุฌู ูุงูุตูุฑุฉ ุฅูู ุฎุท ุงูุฃูุงุจูุจ
image = pipeline(prompt, image=init_image).images[0]
make_image_grid([init_image, image], rows=1, cols=2)
```

<div class="flex gap-4">
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-init.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงูุฃูููุฉ</figcaption>
</div>
<div>
<img class="rounded-xl" src="https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/diffusers/img2img-kandinsky.png"/>
<figcaption class="mt-2 text-center text-sm text-gray-500">ุงูุตูุฑุฉ ุงููููุฏุฉ</figcaption>
</div>
</div>

## ุชูููู ูุนููุงุช ุฎุท ุงูุฃูุงุจูุจ

ููุงู ุงูุนุฏูุฏ ูู ุงููุนููุงุช ุงููููุฉ ุงูุชู ููููู ุชูููููุง ูู ุฎุท ุงูุฃูุงุจูุจ ูุงูุชู ุณุชุคุซุฑ ุนูู ุนูููุฉ ุฅูุดุงุก ุงูุตูุฑ ูุฌูุฏุฉ ุงูุตูุฑุฉ. ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ูุง ุชูุนูู ูุฐู ุงููุนููุงุช ูููู ูุคุซุฑ ุชุบููุฑูุง ุนูู ุงูุฅุฎุฑุงุฌ.
ุจุงูุชุฃููุฏุ ุณุฃุชุจุน ุชุนูููุงุชู ูู ุงูุชุฑุฌูุฉ.

### ุงูููุฉ

ุชุนุฏ "ุงูููุฉ" strength ุฃุญุฏ ุฃูู ุงููุนููุงุช ุงูุชู ูุฌุจ ูุฑุงุนุงุชูุงุ ูุณูููู ููุง ุชุฃุซูุฑ ูุจูุฑ ุนูู ุงูุตูุฑุฉ ุงูุชู ูุชู ุฅูุดุงุคูุง. ููู ุชุญุฏุฏ ูุฏู ุชุดุงุจู ุงูุตูุฑุฉ ุงููุงุชุฌุฉ ูุน ุงูุตูุฑุฉ ุงูุฃูููุฉ. ูุจุนุจุงุฑุฉ ุฃุฎุฑู:

- ๐ ุชุนุทู ูููุฉ "ููุฉ" ุฃุนูู model ุงููุฒูุฏ ูู "ุงูุฅุจุฏุงุน" ูุฅูุดุงุก ุตูุฑุฉ ุชุฎุชูู ุนู ุงูุตูุฑุฉ ุงูุฃูููุฉุ ูุชุนูู ูููุฉ "ููุฉ" strength ุชุจูุบ 1.0 ุชุฌุงูู ุงูุตูุฑุฉ ุงูุฃูููุฉ ุฅูู ุญุฏ ูุจูุฑ.

- ๐ ุชุนูู ูููุฉ "ููุฉ" ุฃูู ุฃู ุงูุตูุฑุฉ ุงููุงุชุฌุฉ ุฃูุซุฑ ุชุดุงุจูุงู ูุน ุงูุตูุฑุฉ ุงูุฃูููุฉ.

ููุงู ุงุฑุชุจุงุท ุจูู ูุนููุชู "ุงูููุฉ" strength ู "ุนุฏุฏ ุฎุทูุงุช ุงูุงุณุชุฏูุงู" num_inference_steps ูุฃู "ุงูููุฉ" strength ุชุญุฏุฏ ุนุฏุฏ ุฎุทูุงุช ุงูุถุฌูุฌ ุงูุชู ุณูุชู ุฅุถุงูุชูุง. ุนูู ุณุจูู ุงููุซุงูุ ุฅุฐุง ูุงูุช "ุนุฏุฏ ุฎุทูุงุช ุงูุงุณุชุฏูุงู" num_inference_steps ุชุณุงูู 50 ู "ุงูููุฉ" strength ุชุณุงูู 0.8ุ ูุฅู ูุฐุง ูุนูู ุฅุถุงูุฉ 40 (50 * 0.8) ุฎุทูุฉ ูู ุงูุถุฌูุฌ ุฅูู ุงูุตูุฑุฉ ุงูุฃูููุฉุ ุซู ุฅุฒุงูุฉ ุงูุถุฌูุฌ ูู 40 ุฎุทูุฉ ููุญุตูู ุนูู ุงูุตูุฑุฉ ุงูููุดุฃุฉ ุญุฏูุซูุง.

### ูููุงุณ ุงูุชูุฌูู

ููุณุชุฎุฏู ูุนููุฉ "ูููุงุณ ุงูุชูุฌูู" guidance_scale ููุชุญูู ูู ูุฏู ุชูุงูู ุงูุตูุฑุฉ ุงูููุดุฃุฉ ูุน ููุฌู ุงููุต text prompt. ุชุดูุฑ ูููุฉ "ูููุงุณ ุงูุชูุฌูู" guidance_scale ุฃุนูู ุฅูู ุฃู ุงูุตูุฑุฉ ุงูููุดุฃุฉ ุฃูุซุฑ ุชูุงููุงู ูุน ุงูููุฌู promptุ ูู ุญูู ุฃู ูููุฉ "ูููุงุณ ุงูุชูุฌูู" guidance_scale ุฃูู ุชุนูู ุฃู ุงูุตูุฑุฉ ุงูููุดุฃุฉ ูุฏููุง ูุณุงุญุฉ ุฃูุจุฑ ููุงูุญุฑุงู ุนู ุงูููุฌู prompt.

ููููู ุงูุฌูุน ุจูู "ูููุงุณ ุงูุชูุฌูู" guidance_scale ู "ุงูููุฉ" strength ููุฒูุฏ ูู ุงูุชุญูู ุงูุฏููู ูู ูุฏู ุชุนุจูุฑ ุงููููุฐุฌ. ุนูู ุณุจูู ุงููุซุงูุ ููููู ุงูุฌูุน ุจูู "ููุฉ" strength ู "ูููุงุณ ุชูุฌูู" guidance_scale ุนุงูููู ููุฅุจุฏุงุน ุงูุฃูุตูุ ุฃู ุงุณุชุฎุฏุงู ูุฒูุฌ ูู "ููุฉ" strength ู "ูููุงุณ ุชูุฌูู" guidance_scale ููุฎูุถูู ูุฅูุดุงุก ุตูุฑุฉ ุชุดุจู ุงูุตูุฑุฉ ุงูุฃูููุฉ ูููููุง ููุณุช ูููุฏุฉ ุจุดูู ุตุงุฑู ุจุงูููุฌู prompt.

### ุงูููุฌู ุงูุณูุจู

ููุณุชุฎุฏู ุงูููุฌู ุงูุณูุจู negative prompt ูุชูุฌูู ุงููููุฐุฌ ุฅูู ุนุฏู ุชุถููู ุฃุดูุงุก ูู ุตูุฑุฉุ ููููู ุงุณุชุฎุฏุงูู ูุชุญุณูู ุฌูุฏุฉ ุงูุตูุฑุฉ ุฃู ุชุนุฏูููุง. ุนูู ุณุจูู ุงููุซุงูุ ููููู ุชุญุณูู ุฌูุฏุฉ ุงูุตูุฑุฉ ูู ุฎูุงู ุชุถููู ููุฌูุงุช ุณูุจูุฉ ูุซู "ุชูุงุตูู ุณูุฆุฉ" ุฃู "ุถุจุงุจูุฉ" ูุชุดุฌูุน ุงููููุฐุฌ ุนูู ุฅูุดุงุก ุตูุฑุฉ ุฐุงุช ุฌูุฏุฉ ุฃุนูู. ุฃู ููููู ุชุนุฏูู ุตูุฑุฉ ุนู ุทุฑูู ุชุญุฏูุฏ ุงูุฃุดูุงุก ุงูุชู ุณูุชู ุงุณุชุจุนุงุฏูุง ูู ุงูุตูุฑุฉ.

## ุฎุทูุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ ุงููุชุณูุณูุฉ

ููุงู ุจุนุถ ุงูุทุฑู ุงููุซูุฑุฉ ููุงูุชูุงู ุงูุฃุฎุฑู ุงูุชู ููููู ูู ุฎูุงููุง ุงุณุชุฎุฏุงู ุฎุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ image-to-image pipeline ุจุฎูุงู ูุฌุฑุฏ ุฅูุดุงุก ุตูุฑุฉ (ุนูู ุงูุฑุบู ูู ุฃู ุฐูู ุฑุงุฆุน ุฃูุถูุง). ููููู ุงููุถู ูุฏููุง ูุชุณูุณูู ูุน ุฎุทูุท ุฃูุงุจูุจ ุฃุฎุฑู.

### ุงููุต ุฅูู ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ

ูุชูุญ ุชุณูุณู ุฎุท ุฃูุงุจูุจ ุงููุต ุฅูู ุงูุตูุฑุฉ text-to-image ูุฎุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ image-to-image ุฅููุงููุฉ ุฅูุดุงุก ุตูุฑุฉ ูู ุงููุต ูุงุณุชุฎุฏุงู ุงูุตูุฑุฉ ุงูููุดุฃุฉ ูุตูุฑุฉ ุฃูููุฉ ูุฎุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ image-to-image pipeline. ูุฐุง ูููุฏ ุฅุฐุง ููุช ุชุฑูุฏ ุฅูุดุงุก ุตูุฑุฉ ูู ุงูุตูุฑ. ุนูู ุณุจูู ุงููุซุงูุ ุฏุนููุง ูููู ุจุชุณูุณู ูููุฐุฌ Stable Diffusion ููููุฐุฌ Kandinsky.

ุงุจุฏุฃ ุจุฅูุดุงุก ุตูุฑุฉ ุจุงุณุชุฎุฏุงู ุฎุท ุฃูุงุจูุจ ุงููุต ุฅูู ุงูุตูุฑุฉ text-to-image pipeline:

ุงูุขู ููููู ุชูุฑูุฑ ูุฐู ุงูุตูุฑุฉ ุงูููุดุฃุฉ ุฅูู ุฎุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ image-to-image pipeline:
ุจุงูุชุฃููุฏุ ุณุฃูุชุฒู ุจุงูุชุนูููุงุช ุงููุฐููุฑุฉ.

### ุณูุณูุฉ ูู ุงูุตูุฑ ุฅูู ุงูุตูุฑ ุฅูู ุงูุตูุฑ
ููููู ุฃูุถูุง ุชูุตูู ุงูุนุฏูุฏ ูู ุฎุทูุท ุงูุตูุฑ ุฅูู ุงูุตูุฑ ูุฅูุดุงุก ุตูุฑ ุฃูุซุฑ ุฅุซุงุฑุฉ. ูููู ุฃู ูููู ูุฐุง ูููุฏูุง ูุฃุฏุงุก ููู ุงูุฃุณููุจ ุจุดูู ุชูุฑุงุฑู ุนูู ุตูุฑุฉุ ุฃู ุฅูุดุงุก ุตูุฑ GIF ูุตูุฑุฉุ ุฃู ุงุณุชุนุงุฏุฉ ุงูุฃููุงู ุฅูู ุตูุฑุฉุ ุฃู ุงุณุชุนุงุฏุฉ ุงูููุงุทู ุงูููููุฏุฉ ูู ุตูุฑุฉ.

ุงุจุฏุฃ ุจุชูููุฏ ุตูุฑุฉ:

ุชูุนุฏ ุตูุฑ ุงููุถุงุก ุทุฑููุฉ ุฑุงุฆุนุฉ ูุงุณุชูุดุงู ุงูููู ูู ุฑุงุญุฉ ููุฒูู. ูููู ุฃู ุชุณุงุนุฏู ุนูู ูุนุฑูุฉ ุงููุฒูุฏ ุนู ุงูุฃุฌุณุงู ุงูุณูุงููุฉ ูุงูุธูุงูุฑ ุงูููููุฉุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูุฏูู ููุญุฉ ุนู ุฑูุนุฉ ุงูููู. ุณูุงุก ููุช ููุชููุง ุจุงูุชุตููุฑ ุงููููู ูููุงูุฉ ุฃู ููุฌุงู ููุฏุฑุงุณุฉ ุงูุนูููุฉุ ูููู ุฃู ูููู ุงููุตูู ุฅูู ุงูุตูุฑ ุงูููููุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ุฎุทูุฉ ุฃููู ุฑุงุฆุนุฉ.

### ุงูุตูุฑุฉ ุฅูู ุงููุญุณู ุฅูู ูุงุฆู ุงูุฏูุฉ
ููุงู ุทุฑููุฉ ุฃุฎุฑู ูุชูุตูู ุฎุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ ุงูุฎุงุตุฉ ุจู ููู ุงุณุชุฎุฏุงู ุจุฑูุงูุฌ ุงููุญุณู ูุงูุฎุท ูุงุฆู ุงูุฏูุฉ ูุฒูุงุฏุฉ ูุณุชูู ุงูุชูุงุตูู ูู ุงูุตูุฑุฉ ุญููุง.

ุงุจุฏุฃ ุจุฎุท ุฃูุงุจูุจ ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ:

ุชูุนุฏ ุตูุฑ ุงููุถุงุก ุทุฑููุฉ ุฑุงุฆุนุฉ ูุงุณุชูุดุงู ุงูููู ูู ุฑุงุญุฉ ููุฒูู. ูููู ุฃู ุชุณุงุนุฏู ุนูู ูุนุฑูุฉ ุงููุฒูุฏ ุนู ุงูุฃุฌุณุงู ุงูุณูุงููุฉ ูุงูุธูุงูุฑ ุงูููููุฉุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูุฏูู ููุญุฉ ุนู ุฑูุนุฉ ุงูููู. ุณูุงุก ููุช ููุชููุง ุจุงูุชุตููุฑ ุงููููู ูููุงูุฉ ุฃู ููุฌุงู ููุฏุฑุงุณุฉ ุงูุนูููุฉุ ูููู ุฃู ูููู ุงููุตูู ุฅูู ุงูุตูุฑ ุงูููููุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ุฎุทูุฉ ุฃููู ุฑุงุฆุนุฉ.

### ุงูุชุญูู ูู ุฅูุดุงุก ุงูุตูุฑ
ูููู ุฃู ูููู ูุญุงููุฉ ุฅูุดุงุก ุตูุฑุฉ ุชุจุฏู ุจุงูุถุจุท ููุง ุชุฑูุฏ ุฃูุฑูุง ุตุนุจูุงุ ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ุชูููุงุช ูููุงุฐุฌ ุงูุชุญูู ูู ุงูุฅูุดุงุก ูููุฏุฉ ุฌุฏูุง. ูู ุญูู ููููู ุงุณุชุฎุฏุงู "ุณูุจู ุจุฑููุจูุช" ููุชุญูู ุฌุฒุฆููุง ูู ุฅูุดุงุก ุงูุตูุฑุ ููุงู ุทุฑู ุฃูุซุฑ ููุฉ ูุซู ูุฒู ุงููุงุตู ุงูุฒููู ูุดุจูุงุช ุงูุชุญูู.

### ูุฒู ุงููุงุตู ุงูุฒููู
ูุณูุญ ูุฒู ุงููุงุตู ุงูุฒููู ุจุชุบููุฑ ูููุงุณ ุชูุซูู ูู ููููู ูู ููุฌู. ุนูู ุณุจูู ุงููุซุงูุ ูู ููุฌู ูุซู "ุฑุงุฆุฏ ูุถุงุก ูู ุงูุบุงุจุฉุ ููุญุฉ ุฃููุงู ุจุงุฑุฏุฉุ ุฃููุงู ุฎุงูุชุฉุ ุชูุงุตููุ 8k"ุ ููููู ุงุฎุชูุงุฑ ุฒูุงุฏุฉ ุฃู ุชูููู ุชุถููู "ุฑุงุฆุฏ ุงููุถุงุก" ู "ุงูุบุงุจุฉ". ุชููุฑ ููุชุจุฉ [Compel] (https://github.com/damian0815/compel) ุจูุงุก ุฌููุฉ ุจุณูุทูุง ูุชุนุฏูู ุฃูุฒุงู ุงูููุงุตู ุงูุฒูููุฉ ูุฅูุดุงุก ุงูุชุถูููุงุช. ููููู ูุนุฑูุฉ ููููุฉ ุฅูุดุงุก ุงูุชุถูููุงุช ูู ุฏููู [ูุฒู ุงููุงุตู ุงูุฒููู]. (weighted_prompts)

ูุฏู [AutoPipelineForImage2Image] ูุนููุฉ "prompt_embeds" (ู"negative_prompt_embeds" ุฅุฐุง ููุช ุชุณุชุฎุฏู ููุฌููุง ุณูุจููุง) ุญูุซ ููููู ุชูุฑูุฑ ุงูุชุถูููุงุช ุงูุชู ุชุญู ูุญู ูุนููุฉ "ุงูููุฌู".

ุฃุฑุฌู ุฃู ุชููู ุงูุชุฑุฌูุฉ ูุงุถุญุฉ ููููููุฉุ ูุฅุฐุง ูุงูุช ููุงู ุฃู ุฃุฌุฒุงุก ุชุญุชุงุฌ ุฅูู ุชูุถูุญ ุฃู ุชุนุฏููุ ูุฑุฌู ุฅุนูุงูู ุจุฐูู.
ุจุงูุชุฃููุฏ! ุณุฃุจุฏุฃ ุงูุชุฑุฌูุฉ ูู ููุง:

### ControlNet

ุชููุฑ ControlNets ุทุฑููุฉ ุฃูุซุฑ ูุฑููุฉ ูุฏูุฉ ููุชุญูู ูู ุชูููุฏ ุงูุตูุฑ ูุฃูู ููููู ุงุณุชุฎุฏุงู ุตูุฑุฉ ุดุฑุทูุฉ ุฅุถุงููุฉ. ูููู ุฃู ุชููู ุงูุตูุฑุฉ ุงูุดุฑุทูุฉ ุตูุฑุฉ Canny ุฃู ุฎุฑูุทุฉ ุนูู ุฃู ุชุฌุฒุฆุฉ ุตูุฑุฉุ ูุญุชู ุงูุฎุฑุจุดุงุช! ุฃููุง ูุงู ููุน ุงูุตูุฑุฉ ุงูุดุฑุทูุฉ ุงูุชู ุชุฎุชุงุฑูุงุ ุชููู ControlNet ุจุชูููุฏ ุตูุฑุฉ ุชุญุงูุธ ุนูู ุงููุนูููุงุช ุงูููุฌูุฏุฉ ูููุง.

ุนูู ุณุจูู ุงููุซุงูุ ุฏุนููุง ูุดุชุฑุท ุตูุฑุฉ ุจุงุณุชุฎุฏุงู ุฎุฑูุทุฉ ุนูู ููุญูุงุธ ุนูู ุงููุนูููุงุช ุงูููุงููุฉ ูู ุงูุตูุฑุฉ.

ููุดุชุฑุท ุงูุขู ุตูุฑุฉ ุฌุฏูุฏุฉ ุจูุงุกู ุนูู ุฎุฑูุทุฉ ุงูุนูู ูุงูุตูุฑุฉ ุงูุฃูููุฉ ูุงููุต:

"ุฑุงุฆุฏ ูุถุงุก ูู ุงูุบุงุจุฉุ ููุญุฉ ุฃููุงู ุจุงุฑุฏุฉุ ุฃููุงู ุฎุงูุชุฉุ ููุตูุฉุ 8K"

ุฏุนููุง ูุทุจู [ููุทูุง](https://huggingface.co/nitrosocke/elden-ring-diffusion) ุฌุฏูุฏูุง ุนูู ุงูุตูุฑุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ูู ControlNet ุนู ุทุฑูู ุฑุจุทูุง ุจุฎุท ุฃูุงุจูุจ ูู ุงูุตูุฑุฉ ุฅูู ุงูุตูุฑุฉ:

```py
pipeline = AutoPipelineForImage2Image.from_pretrained(
"nitrosocke/elden-ring-diffusion", torch_dtype=torch.float16,
)
pipeline.enable_model_cpu_offload()
# remove the following line if xFormers is not installed or you have PyTorch 2.0 or higher installed
pipeline.enable_xformers_memory_efficient_attention()

prompt = "elden ring style astronaut in a jungle" # include the token "elden ring style" in the prompt
negative_prompt = "ugly, deformed, disfigured, poor details, bad anatomy"

image_elden_ring = pipeline(prompt, negative_prompt=negative_prompt, image=image_control_net, strength=0.45, guidance_scale=10.5).images[0]
make_image_grid([init_image, depth_image, image_control_net, image_elden_ring], rows=2, cols=2)
```

## ุชุญุณูู

ุฅู ุชุดุบูู ููุงุฐุฌ ุงูุงูุชุดุงุฑ ุจุงูุธ ุงูุชูููุฉ ููุซูู ุงูุงุณุชุฎุฏุงู ููุญูุณุจุฉุ ูููู ุจุจุนุถ ุงูุญูู ุงูุชุญุณูููุฉุ ูู ุงููููู ุชูุงููุง ุชุดุบูููุง ุนูู ูุนุงูุฌุงุช ุงูุฑุณูููุงุช (GPUs) ุงูุงุณุชููุงููุฉ ูุงููุฌุงููุฉ. ุนูู ุณุจูู ุงููุซุงูุ ููููู ุงุณุชุฎุฏุงู ุดูู ุฃูุซุฑ ููุงุกุฉ ูู ุญูุซ ุงูุฐุงูุฑุฉ ููุงูุชูุงู ูุซู ุงูุชูุงู ุงูููุชุฌ ุงูููุทู ุงููููููุฒ ูู PyTorch 2.0 ุฃู xFormers (ููููู ุงุณุชุฎุฏุงู ุฃุญุฏููุงุ ูููู ูุง ุชูุฌุฏ ุญุงุฌุฉ ูุงุณุชุฎุฏุงู ูููููุง). ููููู ุฃูุถูุง ููู ุงููููุฐุฌ ุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุฃุซูุงุก ุงูุชุธุงุฑ ุงูููููุงุช ุงูุฃุฎุฑู ููุฎุท ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ (CPU).

ุจุงุณุชุฎุฏุงู [`torch.compile`](../optimization/torch2.0#torchcompile)ุ ููููู ุฒูุงุฏุฉ ุณุฑุนุฉ ุงูุงุณุชุฏูุงู ูุฏูู ุนู ุทุฑูู ูููุง ุญูู UNet:

ููุนุฑูุฉ ุงููุฒูุฏุ ุฑุงุฌุน ุฏูููู [ุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ](../optimization/memory) ู [Torch 2.0](../optimization/torch2.0).