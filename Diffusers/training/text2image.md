ุจุงูุชุฃููุฏุ ุณุฃููู ุจุชุฑุฌูุฉ ุงููุต ุงูููุฌูุฏ ูู ุงูููุฑุงุช ูุงูุนูุงููู ูุน ุงูุงูุชุฒุงู ุจุงูุชุนูููุงุช ุงูุชู ูุฏูุชูุง.

# ุงููุต ุฅูู ุงูุตูุฑุฉ

ูุตูุญุฉ:

ูุนุฏ ูุต ุงููุต ุฅูู ุงูุตูุฑุฉ ุชุฌุฑูุจููุงุ ููู ุงูุณูู ุฃู ููุฑุท ูู ุงูุชููู ูุฃู ููุงุฌู ูุดููุงุช ูุซู ุงููุณูุงู ุงููุงุฑุซู. ุฌุฑูุจ ุงุณุชูุดุงู ูุนููุงุช ูุฎุชููุฉ ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌ ูู ูุฌููุนุฉ ุจูุงูุงุชู.

ุชูุณุชุฎุฏู ููุงุฐุฌ ุงููุต ุฅูู ุงูุตูุฑุฉ ูุซู Stable Diffusion ูุฅูุดุงุก ุตูุฑ ุจูุงุกู ุนูู ููุฌู ูุตู.

ูููู ุฃู ูููู ุชุฏุฑูุจ ุงููููุฐุฌ ูุฑูููุง ูุฃุฌูุฒุชูุ ูููู ุฅุฐุง ููุช ุจุชูููู "checkpointing_gradient" ู"mixed_precision"ุ ููู ุงููููู ุชุฏุฑูุจ ูููุฐุฌ ุนูู ูุญุฏุฉ GPU ูุงุญุฏุฉ ุจุณุนุฉ 24 ุฌูุฌุงุจุงูุช. ุฅุฐุง ููุช ุชุชุฏุฑุจ ุจุงุณุชุฎุฏุงู ุฃุญุฌุงู ุฏูุนุงุช ุฃูุจุฑ ุฃู ุชุฑูุฏ ุงูุชุฏุฑูุจ ุจุดูู ุฃุณุฑุนุ ููู ุงูุฃูุถู ุงุณุชุฎุฏุงู ูุญุฏุงุช GPU ุงูุชู ุชุญุชูู ุนูู ุฃูุซุฑ ูู 30 ุฌูุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ. ููููู ุชูููู ุงูุจุตูุฉ ุงูุฎุงุตุฉ ุจู ุนู ุทุฑูู ุชูููู ุงูุงูุชูุงู ุจููุงุกุฉ ุงูุฐุงูุฑุฉ ูุน [xFormers]. ูุฏุนู ุงูุชุฏุฑูุจ JAX/Flax ุฃูุถูุง ุงูุชุฏุฑูุจ ุงููุนุงู ุนูู ูุญุฏุงุช TPU ูGPUุ ููููู ูุง ูุฏุนู ููุทุฉ ุชูุชูุด ุงูุชุฏุฑุฌ ุฃู ุชุฑุงูู ุงูุชุฏุฑุฌ ุฃู xFormers. ููุตู ุจุงุณุชุฎุฏุงู GPU ุจุณุนุฉ 30 ุฌูุฌุงุจุงูุช ุนูู ุงูุฃูู ุฃู TPU v3 ููุชุฏุฑูุจ ุจุงุณุชุฎุฏุงู Flax.

ุณูุชูุงูู ูุฐุง ุงูุฏููู ุจุฑูุงูุฌ ุงููุต ุงูุจุฑูุฌู [train_text_to_image.py] (https://github.com/huggingface/diffusers/blob/main/examples/text_to_image/train_text_to_image.py) ููุณุงุนุฏุชู ุนูู ุงูุชุนุฑู ุนูููุ ูููู ููููู ุชููููู ูุน ุญุงูุชู ุงูุงุณุชุฎุฏุงู ุงูุฎุงุต.

ูุจู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตูุ ุชุฃูุฏ ูู ุชุซุจูุช ุงูููุชุจุฉ ูู ุงููุตุฏุฑ:

ูู ุจุชุซุจูุช ุงูููุชุจุฉ ูู ุงููุตุฏุฑ ุนู ุทุฑูู ุงุณุชูุณุงุฎ ุงููุณุชูุฏุน ูุชุดุบูู pip install:

ุซู ุงูุชูู ุฅูู ูุฌูุฏ ุงููุซุงู ุงูุฐู ูุญุชูู ุนูู ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ ููู ุจุชุซุจูุช ุงูุชุจุนูุงุช ุงููุทููุจุฉ ููุจุฑูุงูุฌ ุงููุตู ุงูุฐู ุชุณุชุฎุฏูู:

ูุตูุญุฉ:

๐ค Accelerate ูู ููุชุจุฉ ุชุณุงุนุฏู ุนูู ุงูุชุฏุฑูุจ ุนูู ูุญุฏุงุช GPU/TPU ูุชุนุฏุฏุฉ ุฃู ุจุงุณุชุฎุฏุงู ุงูุฏูุฉ ุงููุฎุชูุทุฉ. ุณูููู ุชููุงุฆููุง ุจุชูููู ุฅุนุฏุงุฏ ุงูุชุฏุฑูุจ ุงูุฎุงุต ุจู ุจูุงุกู ุนูู ุฃุฌูุฒุชู ูุจูุฆุชู. ุงูู ูุธุฑุฉ ุนูู ุฌููุฉ ๐ค Accelerate ุงูุณุฑูุนุฉ ููุนุฑูุฉ ุงููุฒูุฏ.

ูู ุจุชููุฆุฉ ุจูุฆุฉ ๐ค Accelerate:

ูุฅุนุฏุงุฏ ุจูุฆุฉ ๐ค Accelerate ุงูุงูุชุฑุงุถูุฉ ุฏูู ุงุฎุชูุงุฑ ุฃู ุชููููุงุช:

ุฃู ุฅุฐุง ูู ูุฏุนู ุจูุฆุชู ุบูุงููุง ุชูุงุนูููุงุ ูุซู ุฏูุชุฑ ุงูููุงุญุธุงุชุ ูููููู ุงุณุชุฎุฏุงู:

ุฃุฎูุฑูุงุ ุฅุฐุง ููุช ุชุฑูุฏ ุชุฏุฑูุจ ูููุฐุฌ ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุ ูุฑุงุฌุน ุฏููู [ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ููุชุฏุฑูุจ] (https://github.com/huggingface/diffusers/blob/main/docs/create_dataset.md) ููุนุฑูุฉ ููููุฉ ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ุชุนูู ูุน ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ.

## ูุนููุงุช ุงูุจุฑูุงูุฌ ุงููุตู

ูุตูุญุฉ:

ุชุณูุท ุงูุฃูุณุงู ุงูุชุงููุฉ ุงูุถูุก ุนูู ุฃุฌุฒุงุก ูู ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ ุงููููุฉ ูููู ููููุฉ ุชุนุฏูููุ ููููู ูุง ูุบุทู ูู ุฌุงูุจ ูู ุฌูุงูุจ ุงูุจุฑูุงูุฌ ุงููุตู ุจุงูุชูุตูู. ุฅุฐุง ููุช ููุชููุง ุจูุนุฑูุฉ ุงููุฒูุฏุ ููุง ุชุชุฑุฏุฏ ูู ูุฑุงุกุฉ ุงูุจุฑูุงูุฌ ุงููุตู ูุฅุฎุจุงุฑูุง ุฅุฐุง ูุงู ูุฏูู ุฃู ุฃุณุฆูุฉ ุฃู ูุฎุงูู.

ูููุฑ ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ ุงูุนุฏูุฏ ูู ุงููุนููุงุช ููุณุงุนุฏุชู ุนูู ุชุฎุตูุต ุนูููุฉ ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจู. ูููู ุงูุนุซูุฑ ุนูู ุฌููุน ุงููุนููุงุช ููุตูุงุชูุง ูู ุฏุงูุฉ ['parse_args ()'] (https://github.com/huggingface/diffusers/blob/8959c5b9dec1c94d6ba482c94a58d2215c5fd026/examples/text_to_image/train_text_to_image.py#L193). ุชููุฑ ูุฐู ุงูุฏุงูุฉ ููู ุงูุชุฑุงุถูุฉ ููู ูุนููุฉุ ูุซู ุญุฌู ุฏูุนุฉ ุงูุชุฏุฑูุจ ููุนุฏู ุงูุชุนููุ ูููู ููููู ุฃูุถูุง ุชุนููู ูููู ุงูุฎุงุตุฉ ูู ุฃูุฑ ุงูุชุฏุฑูุจ ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฐูู.

ุนูู ุณุจูู ุงููุซุงูุ ูุฅุฌุฑุงุก ุงูุชุฏุฑูุจ ุจุงุณุชุฎุฏุงู ุงูุฏูุฉ ุงููุฎุชูุทุฉ ุจุชูุณูู fp16ุ ุฃุถู ุงููุนููุฉ --mixed_precision ุฅูู ุฃูุฑ ุงูุชุฏุฑูุจ:

ุจุนุถ ุงููุนููุงุช ุงูุฃุณุงุณูุฉ ูุงููููุฉ ุชุดูู:

- pretrained_model_name_or_path: ุงุณู ุงููููุฐุฌ ุนูู Hub ุฃู ูุณุงุฑ ูุญูู ูููููุฐุฌ ุงูุฐู ุชู ุชุฏุฑูุจู ูุณุจููุง
- dataset_name: ุงุณู ูุฌููุนุฉ ุงูุจูุงูุงุช ุนูู Hub ุฃู ูุณุงุฑ ูุญูู ููุฌููุนุฉ ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุงูุชุฏุฑูุจ ุนูููุง
- image_column: ุงุณู ุนููุฏ ุงูุตูุฑุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุงูุชุฏุฑูุจ ุนูููุง
- caption_column: ุงุณู ุนููุฏ ุงููุต ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุงูุชุฏุฑูุจ ุนูููุง
- output_dir: ุงูููุงู ุงูุฐู ุณูุชู ุญูุธ ุงููููุฐุฌ ุงููุฏุฑุจ ููู
- push_to_hub: ูุง ุฅุฐุง ูุงู ุณูุชู ุฏูุน ุงููููุฐุฌ ุงููุฏุฑุจ ุฅูู Hub
- checkpointing_steps: ุชูุฑุงุฑ ุญูุธ ููุทุฉ ุชูุชูุด ุฃุซูุงุก ุชุฏุฑูุจ ุงููููุฐุฌุ ูุฐุง ูููุฏ ุฅุฐุง ุชู ููุงุทุนุฉ ุงูุชุฏุฑูุจ ูุฃู ุณุจุจ ูู ุงูุฃุณุจุงุจุ ูููููู ุงูุงุณุชูุฑุงุฑ ูู ุงูุชุฏุฑูุจ ูู ุชูู ุงูููุทุฉ ุนู ุทุฑูู ุฅุถุงูุฉ --resume_from_checkpoint ุฅูู ุฃูุฑ ุงูุชุฏุฑูุจ ุงูุฎุงุต ุจู

### ูุฒู SNR ุงูุฃุฏูู

ูููู ุฃู ุชุณุงุนุฏ ุงุณุชุฑุงุชูุฌูุฉ ุงููุฒู Min-SNR ูู ุงูุชุฏุฑูุจ ุนู ุทุฑูู ุฅุนุงุฏุฉ ุชูุงุฒู ุงูุฎุณุงุฑุฉ ูุชุญููู ุชูุงุฑุจ ุฃุณุฑุน. ูุฏุนู ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ ุงูุชูุจุค ุจู "epsilon" (ุงูุถูุถุงุก) ุฃู "v_prediction"ุ ูููู Min-SNR ูุชูุงูู ูุน ููุง ููุนู ุงูุชูุจุค. ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุฑุฌูุญ ูุฐู ูุฏุนููุฉ ููุท ุจูุงุณุทุฉ PyTorch ูุบูุฑ ูุชููุฑุฉ ูู ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ Flax.

ุฃุถู ุงููุนููุฉ --snr_gamma ููู ุจุชุนููููุง ุนูู ุงููููุฉ ุงูููุตู ุจูุง 5.0:

ููููู ููุงุฑูุฉ ุฃุณุทุญ ุงูุฎุณุงุฑุฉ ูููู "snr_gamma" ุงููุฎุชููุฉ ูู ูุฐุง ุงูุชูุฑูุฑ Weights and Biases. ุจุงููุณุจุฉ ููุฌููุนุงุช ุงูุจูุงูุงุช ุงูุฃุตุบุฑุ ูุฏ ูุง ุชููู ุชุฃุซูุฑุงุช Min-SNR ูุงุถุญุฉ ููุง ูู ุงูุญุงู ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุฃูุจุฑ.

## ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจ

ูููู ุงูุนุซูุฑ ุนูู ุฑูุฒ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุชุฏุฑูุจูุฉ ูุญููุฉ ุงูุชุฏุฑูุจ ูู ุฏุงูุฉ ['main ()'] (https://github.com/huggingface/diffusers/blob/8959c5b9dec1c94d6ba482c94a58d2215c5fd026/examples/text_to_image/train_text_to_image.py#L490). ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุชูููู ุงูุจุฑูุงูุฌ ุงููุตู ููุชุฏุฑูุจุ ููุฐุง ูู ุงูููุงู ุงูุฐู ุณุชุญุชุงุฌ ุฅูู ุฅุฌุฑุงุก ุชุบููุฑุงุชู ููู.

ูุจุฏุฃ ุงูุจุฑูุงูุฌ ุงููุตู "train_text_to_image" ุนู ุทุฑูู ุชุญููู ุฌุฏูู ุฒููู [https://github.com/huggingface/diffusers/blob/8959c5b9dec1c94d6ba482c94a58d2215c5fd026/examples/text_to_image/train_text_to_image.py#L543] ููููุฒ:

ููููู ุงุฎุชูุงุฑ ุงุณุชุฎุฏุงู ุฌุฏูู ุฒููู ูุฎุชูู ููุง ุฅุฐุง ุฃุฑุฏุช:

ุซู ูููู ุงูุจุฑูุงูุฌ ุงููุตู ุจุชุญููู ูููุฐุฌ UNet:

ูู ุจุชุญููู ูููุฐุฌ UNet2DConditionModel ุงูุฐู ุชู ุชุฏุฑูุจู ูุณุจููุง:

ุจุนุฏ ุฐููุ ูุฌุจ ูุนุงูุฌุฉ ุฃุนูุฏุฉ ุงููุต ูุงูุตูุฑุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ุชููู ุฏุงูุฉ ['tokenize_captions'] (https://github.com/huggingface/diffusers/blob/8959c5b9dec1c94d6ba482c94a58d2215c5fd026/examples/text_to_image/train_text_to_image.py#L724) ุจูุนุงูุฌุฉ ุงููุฏุฎูุงุชุ ูุชุญุฏุฏ ุฏุงูุฉ ['train_transforms'] (https://github.com/huggingface/diffusers/blob/8959c5b9dec1c94d6ba482c94a58d2215c5fd026/examples/text_to_image/train_text_to_image.py#L742) ููุน ุงูุชุญูููุงุช ุงูุชู ูุฌุจ ุชุทุจูููุง ุนูู ุงูุตูุฑุฉ. ูุชู ุชุฌููุน ููุชุง ุงูุฏุงูุชูู ูู "preprocess_train":

ูู ุจูุนุงูุฌุฉ ุงููุฏุฎูุงุช ุนู ุทุฑูู ุชุญููู ุงูุตูุฑ ุฅูู RGB ูุชุทุจูู ุงูุชุญูููุงุช ูุชููููุฒ ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ:

ุฃุฎูุฑูุงุ ุชุชููู ุญููุฉ ุงูุชุฏุฑูุจ [https://github.com/huggingface/diffusers/blob/8959c5b9dec1c94d6ba482c94a58d2215c5fd026/examples/text_to_image/train_text_to_image.py#L878] ูู ุดูุก ุขุฎุฑ. ูููู ุจุชุดููุฑ ุงูุตูุฑ ูู ูุณุงุญุฉ ุฎููุฉุ ูุฅุถุงูุฉ ุถูุถุงุก ุฅูู ุงููุฎููููุ ูุญุณุงุจ ุงูุชุถูููุงุช ุงููุตูุฉ ููุดุฑุทุ ูุชุญุฏูุซ ูุนููุงุช ุงููููุฐุฌุ ูุญูุธ ุงููููุฐุฌ ูุฏูุนู ุฅูู Hub. ุฅุฐุง ููุช ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุญูู ููููุฉ ุนูู ุญููุฉ ุงูุชุฏุฑูุจุ ูุฑุงุฌุน ุงูุจุฑูุงูุฌ ุงูุชุนูููู [ููู ุงูุฃูุงุจูุจ ูุงูููุงุฐุฌ ูุงูุฌุฏุงูู ุงูุฒูููุฉ] (https://github.com/huggingface/diffusers/blob/main/docs/using_diffusers/write_own_pipeline.md) ุงูุฐู ููุณุฑ ุงูููุท ุงูุฃุณุงุณู ูุนูููุฉ ุฅุฒุงูุฉ ุงูุถูุถุงุก.
## ุชุดุบูู ุงูุณูุฑุจุช

ุนูุฏูุง ุชูุชูู ูู ุฅุฌุฑุงุก ุฌููุน ุงูุชุบููุฑุงุช ุฃู ุชููู ุฑุงุถููุง ุนู ุงูุชููุฆุฉ ุงูุงูุชุฑุงุถูุฉุ ุณุชููู ุฌุงูุฒูุง ูุชุดุบูู ุณูุฑุจุช ุงูุชุฏุฑูุจ! ๐

ุจูุฌุฑุฏ ุงูุชูุงุก ุงูุชุฏุฑูุจุ ููููู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงูุฐู ุฏุฑูุจุชู ุญุฏูุซูุง ููุงุณุชูุชุงุฌ:

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุชูุงูููุง ุนูู ุชุฏุฑูุจ ูููุฐุฌ ุงูุตูุฑุฉ ุงููุตูุฉ ุงูุฎุงุต ุจู! ููุนุฑูุฉ ุงููุฒูุฏ ุนู ููููุฉ ุงุณุชุฎุฏุงู ูููุฐุฌู ุงูุฌุฏูุฏุ ูุฏ ุชููู ุงูุฃุฏูุฉ ุงูุชุงููุฉ ูููุฏุฉ:

- ุชุนุฑู ุนูู ููููุฉ [ุชุญููู ุฃูุฒุงู LoRA](../using-diffusers/loading_adapters#LoRA) ููุงุณุชุฏูุงู ุฅุฐุง ููุช ูุฏ ุฏุฑุจูุช ูููุฐุฌู ุจุงุณุชุฎุฏุงู LoRA.
- ุชุนุฑูู ุฃูุซุฑ ุนูู ููููุฉ ูุณุงุนุฏุฉ ุจุนุถ ุงููุนููุงุช ูุซู ูููุงุณ ุงูุชูุฌูู ุฃู ุชูููุงุช ูุซู ุชุฑุฌูุญ ุงููุทุงูุจุฉ ูู ุงูุชุญูู ูู ุงูุงุณุชุฏูุงู ูู ุฏููู ููุงู [ุงููุต ุฅูู ุงูุตูุฑุฉ](../using-diffusers/conditional_image_generation).